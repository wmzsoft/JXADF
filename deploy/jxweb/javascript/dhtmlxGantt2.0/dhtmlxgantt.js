dhtmlx=function(c){for(var b in c){dhtmlx[b]=c[b]}return dhtmlx};dhtmlx.extend_api=function(a,d,c){var b=window[a];if(!b){return}window[a]=function(g){if(g&&typeof g=="object"&&!g.tagName){var f=b.apply(this,(d._init?d._init(g):arguments));for(var e in dhtmlx){if(d[e]){this[d[e]](dhtmlx[e])}}for(var e in g){if(d[e]){this[d[e]](g[e])}else{if(e.indexOf("on")==0){this.attachEvent(e,g[e])}}}}else{var f=b.apply(this,arguments)}if(d._patch){d._patch(this)}return f||this};window[a].prototype=b.prototype;if(c){dhtmlXHeir(window[a].prototype,c)}};dhtmlxAjax={get:function(a,c){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<3);b.waitCall=c;b.loadXML(a);return b},post:function(a,c,d){var b=new dtmlXMLLoaderObject(true);b.async=(arguments.length<4);b.waitCall=d;b.loadXML(a,true,c);return b},getSync:function(a){return this.get(a,null,true)},postSync:function(a,b){return this.post(a,b,null,true)}};function dtmlXMLLoaderObject(b,d,c,a){this.xmlDoc="";if(typeof(c)!="undefined"){this.async=c}else{this.async=true}this.onloadAction=b||null;this.mainObject=d||null;this.waitCall=null;this.rSeed=a||false;return this}dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(b){var a=true;this.check=function(){if((b)&&(b.onloadAction!=null)){if((!b.xmlDoc.readyState)||(b.xmlDoc.readyState==4)){if(!a){return}a=false;dtmlXMLLoaderObject.count++;if(typeof b.onloadAction=="function"){b.onloadAction(b.mainObject,null,null,null,b)}if(b.waitCall){b.waitCall.call(this,b);b.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(c,a){if(this.xmlDoc.responseXML){var b=this.xmlDoc.responseXML.getElementsByTagName(c);if(b.length==0&&c.indexOf(":")!=-1){var b=this.xmlDoc.responseXML.getElementsByTagName((c.split(":"))[1])}var d=b[0]}else{var d=this.xmlDoc.documentElement}if(d){this._retry=false;return d}if(!this._retry&&_isIE){this._retry=true;var a=this.xmlDoc;this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),true);return this.getXMLTopNode(c,a)}dhtmlxError.throwError("LoadXML","Incorrect XML",[(a||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(b,a){if(!_isIE){var c=new DOMParser();this.xmlDoc=c.parseFromString(b,"text/xml")}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.onreadystatechange=function(){};this.xmlDoc.loadXML(b)}if(a){return}if(this.onloadAction){this.onloadAction(this.mainObject,null,null,null,this)}if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(c,b,a,d){if(this.rSeed){c+=((c.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=c;if((!_isIE)&&(window.XMLHttpRequest)){this.xmlDoc=new XMLHttpRequest()}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(b?"POST":"GET",c,this.async);if(d){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(b){this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded")}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||a);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this._filterXPath=null;this._getAllNamedChilds=null;this._retry=null;this.async=null;this.rSeed=null;this.filePath=null;this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;this.doXPath=null;this.doXPathOpera=null;this.doXSLTransToObject=null;this.doXSLTransToString=null;this.loadXML=null;this.loadXMLString=null;this.doSerialization=null;this.xmlNodeToJSON=null;this.getXMLTopNode=null;this.setXSLParamValue=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(d){var c={};for(var b=0;b<d.attributes.length;b++){c[d.attributes[b].name]=d.attributes[b].value}c._tagvalue=d.firstChild?d.firstChild.nodeValue:"";for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b].tagName;if(a){if(!c[a]){c[a]=[]}c[a].push(this.xmlNodeToJSON(d.childNodes[b]))}}return c};function callerFunction(a,b){this.handler=function(c){if(!c){c=window.event}a(c,b);return true};return this.handler}function getAbsoluteLeft(a){return getOffset(a).left}function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){var c=0,b=0;while(a){c=c+parseInt(a.offsetTop);b=b+parseInt(a.offsetLeft);a=a.offsetParent}return{top:c,left:b}}function getOffsetRect(d){var g=d.getBoundingClientRect();var h=document.body;var b=document.documentElement;var a=window.pageYOffset||b.scrollTop||h.scrollTop;var e=window.pageXOffset||b.scrollLeft||h.scrollLeft;var f=b.clientTop||h.clientTop||0;var i=b.clientLeft||h.clientLeft||0;var j=g.top+a-f;var c=g.left+e-i;return{top:Math.round(j),left:Math.round(c)}}function getOffset(a){if(a.getBoundingClientRect){return getOffsetRect(a)}else{return getOffsetSum(a)}}function convertStringToBoolean(a){if(typeof(a)=="string"){a=a.toLowerCase()}switch(a){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if((a||window.event)&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(a)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(c){if(!c){c=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,c);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(c,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var b=dragger.dragNode.pWindow;if(a.pWindow&&a.pWindow.dhtmlDragAndDrop.lastLanding){a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var f=document.createElement("Div");f.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=f.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=c.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=c.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!c.srcElement){var d=c.target}else{d=c.srcElement}dragger.checkLanding(d,c)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){var c=parent.frames[window.name].frameElement.offsetParent;var d=0;var b=0;while(c){d+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);d+=a.split("_")[0]*1;b+=a.split("_")[1]*1}if(e){return d+"_"+b}else{this.fx=d}this.fy=b}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(b,a){if((b)&&(b.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=b;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((b)&&(b.tagName!="BODY")){this.checkLanding(b.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(b,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:b.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(c){if(c){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(c,d){if(c){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=c.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=c.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=c.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=c.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(d))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(b){}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!c||d)?1:0))}}catch(b){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat"){_isIE=8}}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}dtmlXMLLoaderObject.prototype.doXPath=function(c,e,d,i){if(_isKHTML||(!_isIE&&!window.XPathResult)){return this.doXPathOpera(c,e)}if(_isIE){if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(d!=null){e.setProperty("SelectionNamespaces","xmlns:xsl='"+d+"'")}if(i=="single"){return e.selectSingleNode(c)}else{return e.selectNodes(c)||new Array(0)}}else{var a=e;if(!e){if(!this.xmlDoc.nodeName){e=this.xmlDoc.responseXML}else{e=this.xmlDoc}}if(!e){dhtmlxError.throwError("LoadXML","Incorrect XML",[(e||this.xmlDoc),this.mainObject])}if(e.nodeName.indexOf("document")!=-1){a=e}else{a=e;e=e.ownerDocument}var g=XPathResult.ANY_TYPE;if(i=="single"){g=XPathResult.FIRST_ORDERED_NODE_TYPE}var f=new Array();var b=e.evaluate(c,a,function(j){return d},g,null);if(g==XPathResult.FIRST_ORDERED_NODE_TYPE){return b.singleNodeValue}var h=b.iterateNext();while(h){f[f.length]=h;h=b.iterateNext()}return f}};function _dhtmlxError(b,a,c){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(b,a){this.catches[b]=a};_dhtmlxError.prototype.throwError=function(b,a,c){if(this.catches[b]){return this.catches[b](b,a,c)}if(this.catches.ALL){return this.catches.ALL(b,a,c)}alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(c,a){var e=c.replace(/[\/]+/gi,"/").split("/");var d=null;var b=1;if(!e.length){return[]}if(e[0]=="."){d=[a]}else{if(e[0]==""){d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(e[b].replace(/\[[^\]]*\]/g,""));b++}else{return[]}}for(b;b<e.length;b++){d=this._getAllNamedChilds(d,e[b])}if(e[b-1].indexOf("[")!=-1){d=this._filterXPath(d,e[b-1])}return d};dtmlXMLLoaderObject.prototype._filterXPath=function(e,d){var g=new Array();var d=d.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var f=0;f<e.length;f++){if(e[f].getAttribute(d)){g[g.length]=e[f]}}return g};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(e,d){var h=new Array();if(_isKHTML){d=d.toUpperCase()}for(var g=0;g<e.length;g++){for(var f=0;f<e[g].childNodes.length;f++){if(_isKHTML){if(e[g].childNodes[f].tagName&&e[g].childNodes[f].tagName.toUpperCase()==d){h[h.length]=e[g].childNodes[f]}}else{if(e[g].childNodes[f].tagName==d){h[h.length]=e[g].childNodes[f]}}}}return h};function dhtmlXHeir(e,d){for(var f in d){if(typeof(d[f])=="function"){e[f]=d[f]}}return e}function dhtmlxEvent(b,c,a){if(b.addEventListener){b.addEventListener(c,a,false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(b,c,d){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}var a=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+b+"']",d,"http://www.w3.org/1999/XSL/Transform","single");if(a!=null){a.firstChild.nodeValue=c}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(d,b){if(!d){d=this.xslDoc}if(d.responseXML){d=d.responseXML}if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(d)}var a=this.XSLProcessor.transformToDocument(b)}else{var a=new ActiveXObject("Msxml2.DOMDocument.3.0");try{b.transformNodeToObject(d,a)}catch(c){a=b.transformNode(d)}}return a};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(c,b){var a=this.doXSLTransToObject(c,b);if(typeof(a)=="string"){return a}return this.doSerialization(a)};dtmlXMLLoaderObject.prototype.doSerialization=function(b){if(!b){b=this.xmlDoc}if(b.responseXML){b=b.responseXML}if(!_isIE){var a=new XMLSerializer();return a.serializeToString(b)}else{return b.xml}};dhtmlxEventable=function(obj){obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}};obj.detachAllEvents=function(){for(var name in this){if(name.indexOf("ev_")==0){this.detachEvent(name);this[name]=null}}};obj=null};if(!window.dhtmlx){window.dhtmlx={}}(function(){var j=null;function l(q,o){var p=q.callback;k(false);q.box.parentNode.removeChild(q.box);j=q.box=null;if(p){p(o)}}function a(p){if(j){p=p||event;var o=p.which||event.keyCode;if(dhtmlx.message.keyboard){if(o==13||o==32){l(j,true)}if(o==27){l(j,false)}}if(p.preventDefault){p.preventDefault()}return !(p.cancelBubble=true)}}if(document.attachEvent){document.attachEvent("onkeydown",a)}else{document.addEventListener("keydown",a,true)}function k(p){if(!k.cover){k.cover=document.createElement("DIV");k.cover.onkeydown=a;k.cover.className="dhx_modal_cover";document.body.appendChild(k.cover)}var o=document.body.scrollHeight;k.cover.style.display=p?"inline-block":"none"}function f(q,o){var p="dhtmlx_"+q.toLowerCase().replace(/ /g,"_")+"_button";return"<div class='dhtmlx_popup_button "+p+"' result='"+o+"' ><div>"+q+"</div></div>"}function c(p){if(!m.area){m.area=document.createElement("DIV");m.area.className="dhtmlx_message_area";m.area.style[m.position]="5px";document.body.appendChild(m.area)}m.hide(p.id);var o=document.createElement("DIV");o.innerHTML="<div>"+p.text+"</div>";o.className="dhtmlx-info dhtmlx-"+p.type;o.onclick=function(){m.hide(p.id);p=null};if(m.position=="bottom"&&m.area.firstChild){m.area.insertBefore(o,m.area.firstChild)}else{m.area.appendChild(o)}if(p.expire>0){m.timers[p.id]=window.setTimeout(function(){m.hide(p.id)},p.expire)}m.pull[p.id]=o;o=null;return p.id}function g(p,r,u){var t=document.createElement("DIV");t.className=" dhtmlx_modal_box dhtmlx-"+p.type;t.setAttribute("dhxbox",1);var o="";if(p.width){t.style.width=p.width}if(p.height){t.style.height=p.height}if(p.title){o+='<div class="dhtmlx_popup_title">'+p.title+"</div>"}o+='<div class="dhtmlx_popup_text"><span>'+(p.content?"":p.text)+'</span></div><div  class="dhtmlx_popup_controls">';if(r){o+=f(p.ok||"OK",true)}if(u){o+=f(p.cancel||"Cancel",false)}if(p.buttons){for(var q=0;q<p.buttons.length;q++){o+=f(p.buttons[q],q)}}o+="</div>";t.innerHTML=o;if(p.content){var s=p.content;if(typeof s=="string"){s=document.getElementById(s)}if(s.style.display=="none"){s.style.display=""}t.childNodes[p.title?1:0].appendChild(s)}t.onclick=function(x){x=x||event;var w=x.target||x.srcElement;if(!w.className){w=w.parentNode}if(w.className.split(" ")[0]=="dhtmlx_popup_button"){var v=w.getAttribute("result");v=(v=="true")||(v=="false"?false:v);l(p,v)}};p.box=t;if(r||u){j=p}return t}function n(p,q,s){var r=p.tagName?p:g(p,q,s);if(!p.hidden){k(true)}document.body.appendChild(r);var o=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-r.offsetWidth)/2));var t=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-r.offsetHeight)/2));if(p.position=="top"){r.style.top="-3px"}else{r.style.top=t+"px"}r.style.left=o+"px";r.onkeydown=a;r.focus();if(p.hidden){dhtmlx.modalbox.hide(r)}return r}function i(o){return n(o,true,false)}function b(o){return n(o,true,true)}function e(o){return n(o)}function h(p,o,q){if(typeof p!="object"){if(typeof o=="function"){q=o;o=""}p={text:p,type:o,callback:q}}return p}function d(q,p,o,r){if(typeof q!="object"){q={text:q,type:p,expire:o,id:r}}q.id=q.id||m.uid();q.expire=q.expire||m.expire;return q}dhtmlx.alert=function(){var o=h.apply(this,arguments);o.type=o.type||"confirm";return i(o)};dhtmlx.confirm=function(){var o=h.apply(this,arguments);o.type=o.type||"alert";return b(o)};dhtmlx.modalbox=function(){var o=h.apply(this,arguments);o.type=o.type||"alert";return e(o)};dhtmlx.modalbox.hide=function(o){while(o&&o.getAttribute&&!o.getAttribute("dhxbox")){o=o.parentNode}if(o){o.parentNode.removeChild(o);k(false)}};var m=dhtmlx.message=function(r,q,p,s){r=d.apply(this,arguments);r.type=r.type||"info";var o=r.type.split("-")[0];switch(o){case"alert":return i(r);case"confirm":return b(r);case"modalbox":return e(r);default:return c(r);break}};m.seed=(new Date()).valueOf();m.uid=function(){return m.seed++};m.expire=4000;m.keyboard=true;m.position="top";m.pull={};m.timers={};m.hideAll=function(){for(var o in m.pull){m.hide(o)}};m.hide=function(p){var o=m.pull[p];if(o&&o.parentNode){window.setTimeout(function(){o.parentNode.removeChild(o);o=null},2000);o.className+=" hidden";if(m.timers[p]){window.clearTimeout(m.timers[p])}delete m.pull[p]}}})();gantt={version:"2.0.0"};function dhtmlxDetachEvent(b,c,a){if(b.removeEventListener){b.removeEventListener(c,a,false)}else{if(b.detachEvent){b.detachEvent("on"+c,a)}}}dhtmlxEventable=function(obj){obj._silent_mode=false;obj._silentStart=function(){this._silent_mode=true};obj._silentEnd=function(){this._silent_mode=false};obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this._eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){if(this._silent_mode){return true}name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj._eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}};obj.detachAllEvents=function(){for(var name in this){if(name.indexOf("ev_")==0){delete this[name]}}};obj=null};dhtmlx.copy=function(b){var d,c,a;if(b&&typeof b=="object"){a={};c=[Array,Date,Number,String,Boolean];for(d=0;d<c.length;d++){if(b instanceof c[d]){a=d?new c[d](b):new c[d]()}}for(d in b){if(Object.prototype.hasOwnProperty.apply(b,[d])){a[d]=dhtmlx.copy(b[d])}}}return a||b};dhtmlx.mixin=function(d,c,b){for(var a in c){if((!d[a]||b)){d[a]=c[a]}}return d};dhtmlx.defined=function(a){return typeof(a)!="undefined"};dhtmlx.uid=function(){if(!this._seed){this._seed=(new Date).valueOf()}this._seed++;return this._seed};dhtmlx.bind=function(b,a){return function(){return b.apply(a,arguments)}};gantt._get_position=function(d){if(d.getBoundingClientRect){var g=d.getBoundingClientRect();var h=document.body;var b=document.documentElement;var a=window.pageYOffset||b.scrollTop||h.scrollTop;var e=window.pageXOffset||b.scrollLeft||h.scrollLeft;var f=b.clientTop||h.clientTop||0;var i=b.clientLeft||h.clientLeft||0;var j=g.top+a-f;var c=g.left+e-i;return{y:Math.round(j),x:Math.round(c),width:d.offsetHeight,height:d.offsetWidth}}else{var j=0,c=0;while(d){j=j+parseInt(d.offsetTop,10);c=c+parseInt(d.offsetLeft,10);d=d.offsetParent}return{y:j,x:c,width:d.offsetHeight,height:d.offsetWidth}}};gantt._detectScrollSize=function(){var b=document.createElement("div");b.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;";document.body.appendChild(b);var a=b.offsetWidth-b.clientWidth;document.body.removeChild(b);return a};dhtmlxEventable(gantt);gantt._click={};gantt._dbl_click={};gantt._context_menu={};gantt._on_click=function(d){d=d||window.event;var b=d.target||d.srcElement;var f=gantt.locate(d);var a=gantt._find_ev_handler(d,b,gantt._click,f);if(!a){return}if(f!==null){var c=!gantt.checkEvent("onTaskClick")||gantt.callEvent("onTaskClick",[f,d]);if(c&&gantt.config.select_task){gantt.selectTask(f)}}else{gantt.callEvent("onEmptyClick",[d])}};gantt._on_contextmenu=function(c){c=c||window.event;var f=c.target||c.srcElement,b=gantt.locate(f),d=gantt.locate(f,gantt.config.link_attribute);var a=!gantt.checkEvent("onContextMenu")||gantt.callEvent("onContextMenu",[b,d,c]);if(!a){c.preventDefault()}return a};gantt._find_ev_handler=function(g,a,f,h){var d=true;while(a&&a.parentNode){var c=a.className;if(c){c=c.split(" ");for(var b=0;b<c.length;b++){if(!c[b]){continue}if(f[c[b]]){d=f[c[b]].call(gantt,g,h,a);d=!(typeof d!="undefined"&&d!==true)}}}a=a.parentNode}return d};gantt._on_dblclick=function(d){d=d||window.event;var b=d.target||d.srcElement;var f=gantt.locate(d);var a=gantt._find_ev_handler(d,b,gantt._dbl_click,f);if(!a){return}if(f!==null){var c=!gantt.checkEvent("onTaskDblClick")||gantt.callEvent("onTaskDblClick",[f,d]);if(c&&gantt.config.details_on_dblclick){gantt.showLightbox(f)}}};gantt._on_mousemove=function(a){if(gantt.checkEvent("onMouseMove")){var b=gantt.locate(a);gantt._last_move_event=a;gantt.callEvent("onMouseMove",[b,a])}};function dhtmlxDnD(b,a){if(a){this._settings=a}dhtmlxEventable(this);dhtmlxEvent(b,"mousedown",dhtmlx.bind(function(c){this.dragStart(b,c)},this))}dhtmlxDnD.prototype={dragStart:function(f,d){this.config={obj:f,marker:null,started:false,pos:this.getPosition(d),sensitivity:4};if(this._settings){dhtmlx.mixin(this.config,this._settings,true)}var c=dhtmlx.bind(function(h){return this.dragMove(f,h)},this);var a=dhtmlx.bind(function(h){return this.dragScroll(f,h)},this);var b=dhtmlx.bind(function(h){if(dhtmlx.defined(this.config.updates_per_second)){if(!gantt._checkTimeout(this,this.config.updates_per_second)){return true}}return c(h)},this);var g=dhtmlx.bind(function(h){dhtmlxDetachEvent(document.body,"mousemove",b);dhtmlxDetachEvent(document.body,"mouseup",g);return this.dragEnd(f)},this);dhtmlxEvent(document.body,"mousemove",b);dhtmlxEvent(document.body,"mouseup",g);document.body.className+=" gantt_noselect"},dragMove:function(f,d){if(!this.config.marker&&!this.config.started){var h=this.getPosition(d);var c=h.x-this.config.pos.x;var b=h.y-this.config.pos.y;var g=Math.sqrt(Math.pow(Math.abs(c),2)+Math.pow(Math.abs(b),2));if(g>this.config.sensitivity){this.config.started=true;this.config.ignore=false;if(this.callEvent("onBeforeDragStart",[f,d])===false){this.config.ignore=true;return true}var a=this.config.marker=document.createElement("div");a.className="gantt_drag_marker";a.innerHTML="Dragging object";document.body.appendChild(a);this.callEvent("onAfterDragStart",[f,d])}else{this.config.ignore=true}}if(!this.config.ignore){d.pos=this.getPosition(d);this.config.marker.style.left=d.pos.x+"px";this.config.marker.style.top=d.pos.y+"px";this.callEvent("onDragMove",[f,d])}},dragEnd:function(a){if(this.config.marker){this.config.marker.parentNode.removeChild(this.config.marker);this.config.marker=null;this.callEvent("onDragEnd",[])}document.body.className=document.body.className.replace(" gantt_noselect","")},getPosition:function(b){var a=0,c=0;b=b||window.event;if(b.pageX||b.pageY){a=b.pageX;c=b.pageY}else{if(b.clientX||b.clientY){a=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c=b.clientY+document.body.scrollTop+document.documentElement.scrollTop}}return{x:a,y:c}}};gantt._init_grid=function(){this._click.gantt_close=dhtmlx.bind(function(b,c,a){this.close(c)},this);this._click.gantt_open=dhtmlx.bind(function(b,c,a){this.open(c)},this);this._click.gantt_row=dhtmlx.bind(function(d,f,a){if(f!==null){var b=this.getTaskNode(f);var c=Math.max(b.offsetLeft-this.config.task_scroll_offset,0);this._scroll_task_area(c);this.callEvent("onTaskRowClick",[f,a])}},this);this._click.gantt_grid_head_cell=dhtmlx.bind(function(d,f,a){var c=a.getAttribute("column_id");if(!this.callEvent("onGridHeaderClick",[c,d])){return}if(c=="add"){this._click.gantt_add(d,0)}else{if(this.config.sort){var b=(this._sort&&this._sort.direction&&this._sort.name==c)?this._sort.direction:"desc";b=(b=="desc")?"asc":"desc";this._sort={name:c,direction:b};this._render_grid_header();this.sort(c,b=="desc")}}},this);if(!this.config.sort&&this.config.order_branch){this._init_dnd()}this._click.gantt_add=dhtmlx.bind(function(f,h,b){var c=h?this.getTask(h):false,a="";if(c){a=c.start_date}else{var g=this._order[0];a=g?this.getTask(g).start_date:this.config.start_date}if(c){c.$open=true}var d={text:gantt.locale.labels.new_task,start_date:this.templates.xml_format(a),duration:1,progress:0,parent:h};this.callEvent("onTaskCreated",[d]);this.addTask(d);this.showTask(d.id);if(this.config.details_on_create){this.showLightbox(d.id)}},this)};gantt._render_grid=function(){this._calc_grid_width();this._render_grid_header()};gantt._calc_grid_width=function(){if(this.config.autofit){var e=this.config.columns;var b=0;var a=[];var c=[];for(var f=0;f<e.length;f++){var k=parseInt(e[f].width,10);if(window.isNaN(k)){k=50;a.push(f)}c[f]=k;b+=k}var h=this.config.grid_width-b;var d=h/(a.length>0?a.length:(c.length>0?c.length:1));if(a.length>0){var j=h/(a.length?a.length:1);for(var f=0;f<a.length;f++){var g=a[f];c[g]+=j}}else{var j=h/(c.length?c.length:1);for(var f=0;f<c.length;f++){c[f]+=j}}for(var f=0;f<c.length;f++){e[f].width=c[f]}}};gantt._render_grid_header=function(){var f=this.config.columns;var o=[];var b=0,j=this.locale.labels;var c=this.config.scale_height-2;for(var h=0;h<f.length;h++){var n=h==f.length-1;var d=f[h];if(n&&this.config.grid_width>b+d.width){d.width=this.config.grid_width-b}b+=d.width;var g=(this._sort&&d.name==this._sort.name)?("<div class='gantt_sort gantt_"+this._sort.direction+"'></div>"):"";var p="gantt_grid_head_cell"+(" gantt_grid_head_"+d.name)+(n?" gantt_last_cell":"")+this.templates.grid_header_class(d.name,d);var a="width:"+(d.width-(n?1:0))+"px;";var l=(j["column_"+d.name]||d.label);l=l||"";var m="<div class='"+p+"' style='"+a+"' column_id='"+d.name+"'>"+l+g+"</div>";o.push(m)}this.$grid_scale.style.height=(this.config.scale_height-1)+"px";this.$grid_scale.style.lineHeight=c+"px";try{this.$grid_scale.style.width=(b-1)+"px"}catch(k){this.$grid_scale.style.width="0px"}this.$grid_scale.innerHTML=o.join("")};gantt._render_grid_item=function(p){var e=this.config.columns;var q=[];var b=0;for(var h=0;h<e.length;h++){var n=h==e.length-1;var d=e[h];var o;var m;if(d.name=="add"&&h==e.length-1){m="<div class='gantt_add'></div>"}else{if(d.template){m=d.template(p)}else{m=p[d.name]}if(m instanceof Date){m=this.templates.date_grid(m)}m="<div class='gantt_tree_content'>"+m+"</div>"}var k="gantt_cell"+(n?" gantt_last_cell":"");var r="";if(d.tree){for(var g=0;g<p.$level;g++){r+=this.templates.grid_indent(p)}var f=(this._branches[p.id]&&this._branches[p.id].length>0);if(f){r+=this.templates.grid_open(p);r+=this.templates.grid_folder(p)}else{r+=this.templates.grid_blank(p);r+=this.templates.grid_file(p)}}var a="width:"+(d.width-(n?1:0))+"px;";if(dhtmlx.defined(d.align)){a+="text-align:"+d.align+";"}o="<div class='"+k+"' style='"+a+"'>"+r+m+"</div>";q.push(o)}var k=p.$index%2===0?"":" odd";k+=(p.$transparent)?" gantt_transparent":"";if(this.templates.grid_row_class){var l=this.templates.grid_row_class.call(this,p.start_date,p.end_date,p);if(l){k+=" "+l}}if(this.getState().selected_task==p.id){k+=" gantt_selected"}var c=document.createElement("div");c.className="gantt_row"+k;c.style.height=this.config.row_height+"px";c.style.lineHeight=(gantt.config.row_height)+"px";c.setAttribute(this.config.task_attribute,p.id);c.innerHTML=q.join("");return c};gantt.open=function(a){gantt._set_item_state(a,true);this.callEvent("onTaskOpened",[a])};gantt.close=function(a){gantt._set_item_state(a,false);this.callEvent("onTaskClosed",[a])};gantt._set_item_state=function(b,a){if(b&&this._pull[b]){this._pull[b].$open=a;this.refreshData()}};gantt.getTaskIndex=function(c){var b=this._branches[this.getTask(c).parent];for(var a=0;a<b.length;a++){if(b[a]==c){return a}}return -1};gantt.getGlobalTaskIndex=function(c){var b=this._order;for(var a=0;a<b.length;a++){if(b[a]==c){return a}}return -1};gantt.moveTask=function(e,c,h){var d=arguments[3];if(d){if(d===e){return}h=this.getTask(d).parent;c=this.getTaskIndex(d)}h=h||0;var a=this.getTask(e);var b=this._branches[a.parent];var g=this._branches[h];if(c==-1){c=g.length+1}if(a.parent==h){var i=this.getTaskIndex(e);if(i==c){return}if(i<c){c--}}this._branch_update(a.parent,e);g=this._branches[h];var f=g[c];if(!f){g.push(e)}else{g=g.slice(0,c).concat([e]).concat(g.slice(c))}a.parent=h;this._branches[h]=g;this.refreshData()};gantt._init_dnd=function(){var a=new dhtmlxDnD(this.$grid_data,{updates_per_second:60});if(dhtmlx.defined(this.config.dnd_sensitivity)){a.config.sensitivity=this.config.dnd_sensitivity}a.attachEvent("onBeforeDragStart",dhtmlx.bind(function(d,c){var b=this._locateHTML(c);if(!b){return false}if(this.hideQuickInfo){this._hideQuickInfo()}},this));a.attachEvent("onAfterDragStart",dhtmlx.bind(function(f,d){var c=this._locateHTML(d);a.config.marker.innerHTML=c.outerHTML;a.config.id=this.locate(d);var b=this.getTask(a.config.id);b.$open=false;b.$transparent=true;this.refreshData()},this));a.attachEvent("onDragMove",dhtmlx.bind(function(d,j){var o=a.config;var l=this._get_position(this.$grid_data);var n=l.x+10;var m=j.pos.y-10;if(m<l.y){m=l.y}if(m>l.y+this.$grid_data.offsetHeight-this.config.row_height){m=l.y+this.$grid_data.offsetHeight-this.config.row_height}o.marker.style.left=n+"px";o.marker.style.top=m+"px";var k=document.elementFromPoint(l.x-document.body.scrollLeft+1,m-document.body.scrollTop);var b=this.locate(k);if(this.isTaskExists(b)){var g=gantt._get_position(k);var i=this.getTask(b);var p=this.getTask(a.config.id);if(g.y+k.offsetHeight/2<m){var h=this.getGlobalTaskIndex(i.id);var f=this._pull[this._order[h+1+(i.id==p.id?1:0)]];if(f){if(f.id!=p.id){i=f}else{return}}else{f=this._pull[this._order[h+1]];if(f.$level==p.$level){this.moveTask(p.id,-1,f.parent);o.target="next:"+f.id;return}}}if(i.$level==p.$level&&p.id!=i.id){this.moveTask(p.id,0,0,i.id);o.target=i.id}else{if(p.id==i.id){return}var h=this.getGlobalTaskIndex(i.id);var c=this._pull[this._order[h-1]];if(c&&c.$level==p.$level&&p.id!=c.id){this.moveTask(p.id,-1,c.parent);o.target="next:"+c.id}}}return true},this));a.attachEvent("onDragEnd",dhtmlx.bind(function(){this.getTask(a.config.id).$transparent=false;this.refreshData();this.callEvent("onRowDragEnd",[a.config.id,a.config.target])},this))};gantt._scale_helpers={getSum:function(b,e,d){if(d===undefined){d=b.length-1}if(e===undefined){e=0}var c=0;for(var a=e;a<=d;a++){c+=b[a]}return c},setSumWidth:function(f,e,h,g){var d=e.width;if(g===undefined){g=d.length-1}if(h===undefined){h=0}var b=g-h+1;if(h>d.length-1||b<=0||g>d.length-1||!f){return}var a=this.getSum(d,h,g);var c=f-a;this.adjustSize(c,d,h,g);this.adjustSize(-c,d,g+1);e.full_width=this.getSum(d)},splitSize:function(c,d){var a=[];for(var b=0;b<d;b++){a[b]=0}this.adjustSize(c,a);return a},adjustSize:function(a,d,g,h){if(!g){g=0}if(h===undefined){h=d.length-1}var b=h-g+1;var f=this.getSum(d,g,h);var c=0;for(var e=g;e<=h;e++){var j=Math.floor(a*(f?(d[e]/f):(1/b)));d[e]+=j;c+=j}d[d.length-1]+=a-c},sortScales:function(a){function b(e,c){var f=new Date(1970,0,1);return gantt.date.add(f,c,e)-f}a.sort(function(d,c){return b(d.unit,d.step)<b(c.unit,c.step)?1:-1})},primaryScale:function(){gantt._init_template("date_scale");return{unit:gantt.config.scale_unit,step:gantt.config.step,template:gantt.templates.date_scale,date:gantt.config.date_scale,css:gantt.templates.scale_cell_class}},prepareConfigs:function(g,j,a,f){var b=this.prepareScaleConfig(g[g.length-1],j,a).full_width;var h=this.splitSize(f,g.length);var e=[];for(var c=0;c<g.length;c++){var d=this.prepareScaleConfig(g[c],j,b,h[c]);this.formatScales(d);e.push(d)}for(var c=0;c<e.length-1;c++){this.alineScaleColumns(e[e.length-1],e[c])}return e},prepareScaleConfig:function(d,b,c,f){var a=dhtmlx.mixin({count:0,col_width:0,full_width:0,height:f,width:[],trace_x:[]},d);this.eachColumn(d.unit,d.step,function(g){a.count++;a.trace_x.push(new Date(g))});var e=c;a.col_width=Math.floor(e/a.count);if(b){if(a.col_width<b){a.col_width=b;e=a.col_width*a.count}}a.width=this.splitSize(e,a.count);a.full_width=this.getSum(a.width);return a},alineScaleColumns:function(m,l,j,k){var g=l.trace_x;var h=m.trace_x;var b=j||0;var c=k||(h.length-1);var f=0;for(var d=1;d<g.length;d++){for(var e=b;e<=c;e++){if(+h[e]==+g[d]){var i=this.getSum(m.width,b,e-1);var a=this.getSum(l.width,f,d-1);if(a!=i){this.setSumWidth(i,l,f,d-1)}b=e;f=d;continue}}}},eachColumn:function(c,b,f){var e=new Date(gantt._min_date),a=new Date(gantt._max_date);if(gantt.date[c+"_start"]){e=gantt.date[c+"_start"](e)}var d=new Date(e);while(+d<+a){f.call(this,new Date(d));d=gantt.date.add(d,b,c)}},formatScales:function(j,l){var b=j.trace_x;var e=-1;var f=0,o=j.width.length-1;var m=0;if(+b[0]<+gantt._min_date&&f!=o){var c=Math.floor(j.width[0]*((b[1]-gantt._min_date)/(b[1]-b[0])));m+=j.width[0]-c;j.width[0]=c;b[0]=new Date(gantt._min_date)}var n=b.length-1;var a=b[n];var k=gantt.date.add(a,j.step,j.unit);if(+k>+gantt._max_date&&n>0){var c=j.width[n]-Math.floor(j.width[n]*((k-gantt._max_date)/(k-a)));m+=j.width[n]-c;j.width[n]=c}if(m){var h=this.getSum(j.width);var d=0;for(var g=0;g<j.width.length;g++){var p=Math.floor(m*(j.width[g]/h));j.width[g]+=p;d+=p}this.adjustSize(m-d,j.width)}}};gantt._tasks_dnd={drag:null,_events:{before_start:{},before_finish:{},after_finish:{}},_handlers:{},init:function(){this.clear_drag_state();var c=gantt.config.drag_mode;this.set_actions();var a={before_start:"onBeforeTaskDrag",before_finish:"onBeforeTaskChanged",after_finish:"onAfterTaskDrag"};for(var b in this._events){for(var d in c){this._events[b][d]=a[b]}}this._handlers[c.move]=this._move;this._handlers[c.resize]=this._resize;this._handlers[c.progress]=this._resize_progress},set_actions:function(){var a=gantt.$task_data;dhtmlxEvent(a,"mousemove",dhtmlx.bind(function(b){this.on_mouse_move(b||event)},this));dhtmlxEvent(a,"mousedown",dhtmlx.bind(function(b){this.on_mouse_down(b||event)},this));dhtmlxEvent(a,"mouseup",dhtmlx.bind(function(b){this.on_mouse_up(b||event)},this))},clear_drag_state:function(){this.drag={id:null,mode:null,pos:null,start:null,obj:null,left:null}},_drag_timeout:function(){if(this._cancel_drag){return false}setTimeout(dhtmlx.bind(function(){this._cancel_drag=false},this),1000/40);return this._cancel_drag=true},_resize:function(d,b,c){var a=gantt.config;if(c.left){d.start_date=new Date(c.start.valueOf()+b)}else{d.end_date=new Date(c.start.valueOf()+b)}if(d.end_date-d.start_date<a.min_duration){if(c.left){d.start_date=new Date(d.end_date.valueOf()-a.min_duration)}else{d.end_date=new Date(d.start_date.valueOf()+a.min_duration)}}gantt._update_task_duration(d)},_resize_progress:function(d,b,c){var f=c.obj_s_x=c.obj_s_x||gantt._pos_from_date(d.start_date);var a=c.obj_e_x=c.obj_e_x||gantt._pos_from_date(d.end_date);var e=Math.max(0,c.pos.x-f);d.progress=Math.min(1,e/(a-f))},_move:function(c,a,b){c.start_date=new Date(b.obj.start_date.valueOf()+a);c.end_date=new Date(b.obj.end_date.valueOf()+a)},on_mouse_move:function(b){if(this.drag.start_drag){this._start_dnd(b)}var a=this.drag;if(a.mode){if(!gantt._checkTimeout(this,40)){return}this._update_on_move(b)}},_update_on_move:function(g){var d=this.drag;if(d.mode){var i=gantt._get_mouse_pos(g);if(d.pos&&d.pos.x==i.x){return}d.pos=i;var b=gantt._date_from_pos(i.x);if(!b||isNaN(b.getTime())){return}var a=b-d.start;var f=gantt.getTask(d.id);if(this._handlers[d.mode]){var c=dhtmlx.mixin({},f);var h=dhtmlx.mixin({},f);this._handlers[d.mode].apply(this,[h,a,d]);dhtmlx.mixin(f,h,true);gantt._update_parents(d.id,true);gantt.callEvent("onTaskDrag",[f.id,d.mode,h,c,g]);dhtmlx.mixin(f,h,true);gantt._update_parents(d.id);gantt.refreshTask(d.id)}}},on_mouse_down:function(d,f){if(d.button==2){return}if(gantt.config.readonly||this.drag.mode){return}this.clear_drag_state();f=f||(d.target||d.srcElement);var c=gantt._trim(f.className||"");if(!c||!this._get_drag_mode(c)){if(f.parentNode){return this.on_mouse_down(d,f.parentNode)}else{return}}var b=this._get_drag_mode(c);if(!b){if(gantt.checkEvent("onMouseDown")&&gantt.callEvent("onMouseDown",[c.split(" ")[0]])){if(f.parentNode){return this.on_mouse_down(d,f.parentNode)}}}else{if(b.mode&&b.mode!=gantt.config.drag_mode.ignore&&gantt.config["drag_"+b.mode]){var h=gantt.locate(f),a=dhtmlx.copy(gantt.getTask(h)||{});if(gantt._is_flex_task(a)&&b.mode!=gantt.config.drag_mode.progress){this.clear_drag_state();return}b.id=h;var g=gantt._get_mouse_pos(d);b.start=gantt._date_from_pos(g.x);b.obj=a;this.drag.start_drag=b}else{this.clear_drag_state()}}},on_mouse_up:function(d){var a=this.drag;if(a.mode&&a.id){var b=gantt.getTask(a.id);if(!this._fireEvent("before_finish",a.mode,[a.id,a.mode,dhtmlx.copy(a.obj),d])){a.obj._dhx_changed=false;dhtmlx.mixin(b,a.obj,true);gantt.updateTask(b.id)}else{var c=a.id;this.clear_drag_state();if(gantt.config.round_dnd_dates){var f=gantt._tasks;gantt._round_task_dates(b,f.step,f.unit)}else{gantt._round_task_dates(b,gantt.config.time_step,"minute")}gantt._update_task_duration(b);gantt.updateTask(b.id);this._fireEvent("after_finish",a.mode,[c,a.mode,d])}}this.clear_drag_state()},_get_drag_mode:function(c){var d=gantt.config.drag_mode;var a=(c||"").split(" ");var e=a[0];var b={mode:null,left:null};switch(e){case"gantt_task_line":case"gantt_task_content":b.mode=d.move;break;case"gantt_task_drag":b.mode=d.resize;if(a[1]&&a[1].indexOf("left",a[1].length-"left".length)!==-1){b.left=true}break;case"gantt_task_progress_drag":b.mode=d.progress;break;case"gantt_link_control":case"gantt_link_point":b.mode=d.ignore;break;default:b=null;break}return b},_start_dnd:function(c){var b=this.drag=this.drag.start_drag;delete b.start_drag;var a=gantt.config;var d=b.id;if(!a["drag_"+b.mode]||!gantt.callEvent("onBeforeDrag",[d,b.mode,c])||!this._fireEvent("before_start",b.mode,[d,b.mode,c])){this.clear_drag_state()}else{delete b.start_drag}},_fireEvent:function(b,d,c){dhtmlx.assert(this._events[b],"Invalid stage:{"+b+"}");var a=this._events[b][d];dhtmlx.assert(a,"Unknown after drop mode:{"+d+"}");dhtmlx.assert(c,"Invalid event arguments");if(!gantt.checkEvent(a)){return true}return gantt.callEvent(a,c)}};gantt._render_link=function(b){var a=this.getLink(b);gantt._linkRenderer.render_item(a,this.$task_links)};gantt._get_link_type=function(b,a){var c;if(b&&a){c=gantt.config.links.start_to_start}else{if(!b&&a){c=gantt.config.links.finish_to_start}else{if(!b&&!a){c=gantt.config.links.finish_to_finish}else{if(b&&!a){c=null}}}}return c};gantt.isLinkAllowed=function(f,e,b,a){if(typeof(f)=="object"){var d=f}else{var d={source:f,target:e,type:this._get_link_type(b,a)}}if(!d){return false}if(!(d.source&&d.target&&d.type)){return false}if(d.source==d.target){return false}var c=true;if(this.checkEvent("onLinkValidation")){c=this.callEvent("onLinkValidation",[d])}return c};gantt._render_link_element=function(g){if(!(gantt.isTaskVisible(g.source)&&gantt.isTaskVisible(g.target))){return}var e=this._path_builder.get_points(g);var b=gantt._drawer;var k=b.get_lines(e);var a=document.createElement("div");var d="gantt_task_link";var f=this.templates.link_class?this.templates.link_class(g):"";if(f){d+=" "+f}a.className=d;a.setAttribute(gantt.config.link_attribute,g.id);for(var c=0;c<k.length;c++){if(c==k.length-1){k[c].size-=gantt.config.link_arrow_size}a.appendChild(b.render_line(k[c],k[c+1]))}var h=k[k.length-1].direction;var j=gantt._render_link_arrow(e[e.length-1],h);a.appendChild(j);return a};gantt._render_link_arrow=function(h,g){var a=document.createElement("div");var d=gantt._drawer;var f=h.y;var c=h.x;var i=gantt.config.link_arrow_size;var b=gantt.config.row_height;var e="gantt_link_arrow gantt_link_arrow_"+g;switch(g){case d.dirs.right:f-=(i-b)/2;c-=i;break;case d.dirs.left:f-=(i-b)/2;break;case d.dirs.up:c-=(i-b)/2;break;case d.dirs.down:f-=i;c-=(i-b)/2;break;default:break}a.style.cssText=["top:"+f+"px","left:"+c+"px"].join(";");a.className=e;return a};gantt._drawer={current_pos:null,dirs:{left:"left",right:"right",up:"up",down:"down"},path:[],clear:function(){this.current_pos=null;this.path=[]},point:function(a){this.current_pos=dhtmlx.copy(a)},get_lines:function(b){this.clear();this.point(b[0]);for(var a=1;a<b.length;a++){this.line_to(b[a])}return this.get_path()},line_to:function(d){var b=dhtmlx.copy(d);var c=this.current_pos;var a=this._get_line(c,b);this.path.push(a);this.current_pos=b},get_path:function(){return this.path},get_wrapper_sizes:function(b){var d,c=gantt.config.link_wrapper_width,a=gantt.config.link_line_width,e=b.y+(gantt.config.row_height-c)/2;switch(b.direction){case this.dirs.left:d={top:e,height:c,lineHeight:c,left:b.x-b.size-c/2,width:b.size+c};break;case this.dirs.right:d={top:e,lineHeight:c,height:c,left:b.x-c/2,width:b.size+c};break;case this.dirs.up:d={top:e-b.size,lineHeight:b.size+c,height:b.size+c,left:b.x-c/2,width:c};break;case this.dirs.down:d={top:e,lineHeight:b.size+c,height:b.size+c,left:b.x-c/2,width:c};break;default:break}return d},get_line_sizes:function(b){var e,a=gantt.config.link_line_width,d=gantt.config.link_wrapper_width,c=b.size+a;switch(b.direction){case this.dirs.left:case this.dirs.right:e={height:a,width:c,marginTop:(d-a)/2,marginLeft:(d-a)/2};break;case this.dirs.up:case this.dirs.down:e={height:c,width:a,marginTop:(d-a)/2,marginLeft:(d-a)/2};break;default:break}return e},render_line:function(b){var e=this.get_wrapper_sizes(b);var d=document.createElement("div");d.style.cssText=["top:"+e.top+"px","left:"+e.left+"px","height:"+e.height+"px","width:"+e.width+"px"].join(";");d.className="gantt_line_wrapper";var c=this.get_line_sizes(b);var a=document.createElement("div");a.style.cssText=["height:"+c.height+"px","width:"+c.width+"px","margin-top:"+c.marginTop+"px","margin-left:"+c.marginLeft+"px"].join(";");a.className="gantt_link_line_"+b.direction;d.appendChild(a);return d},_get_line:function(d,c){var b=this.get_direction(d,c);var a={x:d.x,y:d.y,direction:this.get_direction(d,c)};if(b==this.dirs.left||b==this.dirs.right){a.size=Math.abs(d.x-c.x)}else{a.size=Math.abs(d.y-c.y)}return a},get_direction:function(c,b){var a=0;if(b.x<c.x){a=this.dirs.left}else{if(b.x>c.x){a=this.dirs.right}else{if(b.y>c.y){a=this.dirs.down}else{a=this.dirs.up}}}return a}};gantt._y_from_ind=function(a){return(a)*gantt.config.row_height};gantt._path_builder={path:[],clear:function(){this.path=[]},current:function(){return this.path[this.path.length-1]},point:function(a){if(!a){return this.current()}this.path.push(dhtmlx.copy(a));return a},point_to:function(d,c,a){if(!a){a=dhtmlx.copy(this.point())}else{a={x:a.x,y:a.y}}var b=gantt._drawer.dirs;switch(d){case (b.left):a.x-=c;break;case (b.right):a.x+=c;break;case (b.up):a.y-=c;break;case (b.down):a.y+=c;break;default:break}return this.point(a)},get_points:function(d){var g=this.get_endpoint(d);var h=gantt.config;var f=g.e_y-g.y;var i=g.e_x-g.x;var b=gantt._drawer.dirs;this.clear();this.point({x:g.x,y:g.y});var e=2*h.link_arrow_size;var c=(g.e_x>g.x);if(d.type==gantt.config.links.start_to_start){this.point_to(b.left,e);if(c){this.point_to(b.down,f);this.point_to(b.right,i)}else{this.point_to(b.right,i);this.point_to(b.down,f)}this.point_to(b.right,e)}else{if(d.type==gantt.config.links.finish_to_start){c=(g.e_x>(g.x+2*e));this.point_to(b.right,e);if(c){i-=e;this.point_to(b.down,f);this.point_to(b.right,i)}else{i-=2*e;var a=f>0?1:-1;this.point_to(b.down,a*(h.row_height/2));this.point_to(b.right,i);this.point_to(b.down,a*(Math.abs(f)-(h.row_height/2)));this.point_to(b.right,e)}}else{if(d.type==gantt.config.links.finish_to_finish){this.point_to(b.right,e);if(c){this.point_to(b.right,i);this.point_to(b.down,f)}else{this.point_to(b.down,f);this.point_to(b.right,i)}this.point_to(b.left,e)}}}return this.path},get_endpoint:function(e){var b=gantt.config.links;var f=gantt._get_visible_order(e.source);var d=gantt._get_visible_order(e.target);var c,a;if(e.type==b.start_to_start){c=gantt._pull[e.source].start_date;a=gantt._pull[e.target].start_date}else{if(e.type==b.finish_to_finish){c=gantt._pull[e.source].end_date;a=gantt._pull[e.target].end_date}else{if(e.type==b.finish_to_start){c=gantt._pull[e.source].end_date;a=gantt._pull[e.target].start_date}else{dhtmlx.assert(false,"Invalid link type")}}}return{x:gantt._pos_from_date(c),e_x:gantt._pos_from_date(a),y:gantt._y_from_ind(f),e_y:gantt._y_from_ind(d)}}};gantt._init_links_dnd=function(){var a=new dhtmlxDnD(this.$task_bars,{sensitivity:0,updates_per_second:60});var i="task_left";var j="gantt_link_point";var m="gantt_link_control";a.attachEvent("onBeforeDragStart",dhtmlx.bind(function(r,q){var p=(q.target||q.srcElement);e();if(gantt.getState().drag_id){return false}if(gantt._locate_css(p,j)){if(gantt._locate_css(p,i)){gantt._link_source_task_start=true}var n=gantt._link_source_task=this.locate(q);var o=gantt.getTask(n);this._dir_start={y:gantt._y_from_ind(gantt._get_visible_order(n))+gantt.config.row_height/2,x:gantt._pos_from_date(gantt._link_source_task_start?o.start_date:o.end_date)};return true}else{return false}},this));a.attachEvent("onAfterDragStart",dhtmlx.bind(function(o,n){f(a.config.marker)},this));a.attachEvent("onDragMove",dhtmlx.bind(function(o,s){var y=a.config;var x=a.getPosition(s);g(y.marker,x);var u=gantt._is_link_drop_area(s);var A=gantt._link_target_task;var q=gantt._link_landing;var p=gantt._link_target_task_start;var w=gantt.locate(s);if(u){var v=false;var v=!!gantt._locate_css(s,i);var u=!!w}gantt._link_target_task=w;gantt._link_landing=u;gantt._link_target_task_start=v;if(u){var z=gantt.getTask(w);var n=Math.floor((s.srcElement||s.target).offsetWidth/2);this._dir_end={y:gantt._y_from_ind(gantt._get_visible_order(w))+gantt.config.row_height/2,x:gantt._pos_from_date(v?z.start_date:z.end_date)+(v?-1:1)*n}}else{this._dir_end=gantt._get_mouse_pos(s)}var r=!(q==u&&A==w&&p==v);if(r){if(A){gantt.refreshTask(A,false)}if(w){gantt.refreshTask(w,false)}}if(r){f(y.marker)}b(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y);return true},this));a.attachEvent("onDragEnd",dhtmlx.bind(function(){var o=h();if(o.from&&o.to&&o.from!=o.to){var n=gantt._get_link_type(o.from_start,o.to_start);if(n){gantt.addLink({source:o.from,target:o.to,type:n})}}e();if(o.from){gantt.refreshTask(o.from,false)}if(o.to){gantt.refreshTask(o.to,false)}k()},this));function f(n){var r=h();var p=["gantt_link_tooltip"];if(r.from&&r.to){if(gantt.isLinkAllowed(r.from,r.to,r.from_start,r.to_start)){p.push("gantt_allowed_link")}else{p.push("gantt_invalid_link")}}var q=gantt.templates.drag_link_class(r.from,r.from_start,r.to,r.to_start);if(q){p.push(q)}var o="<div class='"+q+"'>"+gantt.templates.drag_link(r.from,r.from_start,r.to,r.to_start)+"</div>";n.innerHTML=o}function g(n,o){n.style.left=o.x+5+"px";n.style.top=o.y+5+"px"}function h(){return{from:gantt._link_source_task,to:gantt._link_target_task,from_start:gantt._link_source_task_start,to_start:gantt._link_target_task_start}}function e(){gantt._link_source_task=gantt._link_source_task_start=gantt._link_target_task=gantt._link_target_task_start=null}function b(B,y,x,t){var o=c();var A=h();var r=["gantt_link_direction"];if(gantt.templates.link_direction_class){r.push(gantt.templates.link_direction_class(A.from,A.from_start,A.to,A.to_start))}var w=Math.sqrt((Math.pow(x-B,2))+(Math.pow(t-y,2)));w=Math.max(0,w-3);if(!w){return}o.className=r.join(" ");var v=(t-y)/(x-B),q=Math.atan(v);if(l(B,x,y,t)==2){q+=Math.PI}else{if(l(B,x,y,t)==3){q-=Math.PI}}var u=Math.sin(q),D=Math.cos(q),z=Math.round(y),p=Math.round(B);var n=["-webkit-transform: rotate("+q+"rad)","-moz-transform: rotate("+q+"rad)","-ms-transform: rotate("+q+"rad)","-o-transform: rotate("+q+"rad)","transform: rotate("+q+"rad)","width:"+Math.round(w)+"px"];if(window.navigator.userAgent.indexOf("MSIE 8.0")!=-1){n.push('-ms-filter: "'+d(u,D)+'"');var C=Math.abs(Math.round(B-x)),s=Math.abs(Math.round(t-y));switch(l(B,x,y,t)){case 1:z-=s;break;case 2:p-=C;z-=s;break;case 3:p-=C;break;default:break}}n.push("top:"+z+"px");n.push("left:"+p+"px");o.style.cssText=n.join(";")}function d(n,o){return"progid:DXImageTransform.Microsoft.Matrix(M11 = "+o+",M12 = -"+n+",M21 = "+n+",M22 = "+o+",SizingMethod = 'auto expand')"}function l(q,o,p,n){if(o>=q){if(n<=p){return 1}else{return 4}}else{if(n<=p){return 2}else{return 3}}}function c(){if(!a._direction){a._direction=document.createElement("div");gantt.$task_links.appendChild(a._direction)}return a._direction}function k(){if(a._direction){a._direction.parentNode.removeChild(a._direction);a._direction=null}}gantt._is_link_drop_area=function(n){return !!gantt._locate_css(n,m)}};gantt._get_link_state=function(){return{link_landing_area:this._link_landing,link_target_id:this._link_target_task,link_target_start:this._link_target_task_start,link_source_id:this._link_source_task,link_source_start:this._link_source_task_start}};gantt._init_tasks=function(){this._tasks={col_width:this.config.columnWidth,width:[],full_width:0,trace_x:[],rendered:{}};this._click.gantt_task_link=dhtmlx.bind(function(c,b){var d=this.locate(c,gantt.config.link_attribute);if(d){this.callEvent("onLinkClick",[d,c])}},this);this._dbl_click.gantt_task_link=dhtmlx.bind(function(c,d,b){var d=this.locate(c,gantt.config.link_attribute);this._delete_link_handler(d,c)},this);this._dbl_click.gantt_link_point=dhtmlx.bind(function(f,g,b){var g=this.locate(f),c=this.getTask(g);var d=null;if(b.parentNode&&b.parentNode.className){if(b.parentNode.className.indexOf("_left")>-1){d=c.$target[0]}else{d=c.$source[0]}}if(d){this._delete_link_handler(d,f)}return false},this);this._tasks_dnd.init();this._init_links_dnd();this._taskRenderer=gantt._task_renderer("line",this._render_task_element,this.$task_bars);this._linkRenderer=gantt._task_renderer("links",this._render_link_element,this.$task_links);this._gridRenderer=gantt._task_renderer("grid_items",this._render_grid_item,this.$grid_data);this._bgRenderer=gantt._task_renderer("bg_lines",this._render_bg_line,this.$task_bg);function a(d,f,b,e){for(var c=0;c<d.length;c++){d[c].change_id(f,b);d[c].render_item(e)}}this.attachEvent("onTaskIdChange",function(d,b){var c=this._get_task_renderers();a(c,d,b,this.getTask(b))});this.attachEvent("onLinkIdChange",function(d,b){var c=this._get_link_renderers();a(c,d,b,this.getLink(b))})};gantt._get_task_renderers=function(){return[this._taskRenderer,this._gridRenderer,this._bgRenderer]};gantt._get_link_renderers=function(){return[this._linkRenderer]};gantt._delete_link_handler=function(d,b){if(d&&this.callEvent("onLinkDblClick",[d,b])){var c="";var a=gantt.locale.labels.link+" "+this.templates.link_description(this.getLink(d))+" "+gantt.locale.labels.confirm_link_deleting;window.setTimeout(function(){gantt._dhtmlx_confirm(a,c,function(){gantt.deleteLink(d)})},(gantt.config.touch?300:1))}};gantt.getTaskNode=function(a){return this._taskRenderer.rendered[a]};gantt.getLinkNode=function(a){return this._linkRenderer.rendered[a]};gantt._get_tasks_data=function(){var c=[];for(var a=0;a<this._order.length;a++){var b=this._pull[this._order[a]];b.$index=a;this._update_parents(b.id,true);c.push(b)}return c};gantt._get_links_data=function(){var a=[];for(var b in this._lpull){a.push(this._lpull[b])}return a};gantt._render_data=function(){this._update_layout_sizes();var d=this._get_tasks_data();var b=this._get_task_renderers();for(var c=0;c<b.length;c++){b[c].render_items(d)}var a=gantt._get_links_data();b=this._get_link_renderers();for(var c=0;c<b.length;c++){b[c].render_items(a)}};gantt._update_layout_sizes=function(){var b=this._tasks;var a=this.config.task_height;if(a=="full"){a=this.config.row_height-5}a=Math.min(a,this.config.row_height);b.bar_height=a;this.$task_data.style.height=this.$task.offsetHeight-this.config.scale_height+"px";this.$task_bg.style.width=b.full_width+"px";var d=this.config.columns;var f=0;for(var c=0;c<d.length;c++){f+=d[c].width}try{this.$grid_data.style.width=(f-1)+"px"}catch(g){this.$grid_data.style.width="0px"}};gantt._init_tasks_range=function(){var d=this.config.scale_unit;if(this.config.start_date&&this.config.end_date){this._min_date=this.date[d+"_start"](new Date(this.config.start_date));this._max_date=this.date[d+"_start"](new Date(this.config.end_date));return}var e=this._get_tasks_data();var b=this._init_task({id:0});e.push(b);var a=-Infinity,c=Infinity;this.eachTask(function(f){if(+f.end_date>+a){a=new Date(f.end_date)}},"0");this.eachTask(function(f){if(+f.start_date<+c){c=new Date(f.start_date)}},"0");this._min_date=c;this._max_date=a;if(!a||a==-Infinity){this._min_date=new Date();this._max_date=new Date(this._min_date)}this._min_date=this.date[d+"_start"](this._min_date);if(+this._min_date==+c){this._min_date=this.date.add(this.date[d+"_start"](this._min_date),-1,d)}this._max_date=this.date[d+"_start"](this._max_date);this._max_date=this.date.add(this._max_date,1,d)};gantt._prepare_scale_html=function(d){var m=[];var e=null,h=null,g=null;if(d.template||d.date){h=d.template||this.date.date_to_str(d.date)}g=d.css||gantt.templates.scale_cell_class;for(var f=0;f<d.count;f++){e=new Date(d.trace_x[f]);var j=h.call(this,e);var b=d.width[f];var a="width:"+(b)+"px;";var c="gantt_scale_cell"+(f==d.count-1?" gantt_last_cell":"");var l=g.call(this,e);if(l){c+=" "+l}var k="<div class='"+c+"' style='"+a+"'>"+j+"</div>";m.push(k)}return m.join("")};gantt._render_tasks_scales=function(){this._init_tasks_range();this._scroll_resize();this._set_sizes();var e=this._scale_helpers;var f=[e.primaryScale()].concat(this.config.subscales);e.sortScales(f);var b=e.prepareConfigs(f,this.config.min_column_width,this.$task.offsetWidth,this.config.scale_height-1);var a=this._tasks=b[b.length-1];var d=[];for(var c=0;c<b.length;c++){d.push('<div class="gantt_scale_line" style="height:'+(b[c].height)+"px;line-height:"+(b[c].height)+'px">'+this._prepare_scale_html(b[c])+"</div>")}this.$task_scale.style.height=(this.config.scale_height-1)+"px";this.$task_data.style.width=this.$task_scale.style.width=a.full_width+this.$scroll_ver.offsetWidth+"px";this.$task_links.style.width=this.$task_bars.style.width=a.full_width+"px";f=d.join("");this.$task_scale.innerHTML=f};gantt._render_bg_line=function(k){var g=gantt._tasks;var f=g.count;var l=[];for(var d=0;d<f;d++){var b=g.width[d];var a="width:"+(b)+"px;";var c="gantt_task_cell"+(d==f-1?" gantt_last_cell":"");h=this.templates.task_cell_class(k,g.trace_x[d]);if(h){c+=" "+h}var i="<div class='"+c+"' style='"+a+"'></div>";l.push(i)}var n=k.$index%2!==0;var h=gantt.templates.task_row_class(k.start_date,k.end_date,k);var e="gantt_task_row"+(n?" odd":"")+(h?" "+h:"");if(this.getState().selected_task==k.id){e+=" gantt_selected"}var m=document.createElement("div");m.className=e;m.style.height=(gantt.config.row_height)+"px";m.setAttribute(this.config.task_attribute,k.id);m.innerHTML=l.join("");return m};gantt._adjust_scales=function(){if(this.config.fit_tasks){var b=+this._min_date,a=+this._max_date;this._init_tasks_range();if(+this._min_date!=b||+this._max_date!=a){this.render();this.callEvent("onScaleAdjusted",[]);return true}}return false};gantt.refreshTask=function(d,a){var e=this._get_task_renderers();var b=this.getTask(d);if(b&&this.isTaskVisible(d)){for(var c=0;c<e.length;c++){e[c].render_item(b)}}else{for(var c=0;c<e.length;c++){e[c].remove_item(d)}}if(a!==undefined&&!a){return}var b=this.getTask(d);for(var c=0;c<b.$source.length;c++){gantt.refreshLink(b.$source[c])}for(var c=0;c<b.$target.length;c++){gantt.refreshLink(b.$target[c])}};gantt.refreshLink=function(a){if(this.isLinkExists(a)){gantt._render_link(a)}else{gantt._linkRenderer.remove_item(a)}};gantt._combine_item_class=function(b,h,e){var c=[b];if(h){c.push(h)}var a=gantt.getState();if(this._is_flex_task(this.getTask(e))){c.push("gantt_dependent_task")}if(this.config.select_task&&e==a.selected_task){c.push("gantt_selected")}if(e==a.drag_id){c.push("gantt_drag_"+a.drag_mode)}var i=gantt._get_link_state();if(i.link_source_id==e){c.push("gantt_link_source")}if(i.link_target_id==e){c.push("gantt_link_target")}if(i.link_landing_area&&(i.link_target_id&&i.link_source_id)&&(i.link_target_id!=i.link_source_id)){var j=i.link_source_id;var g=i.link_source_start;var d=i.link_target_start;var f=gantt.isLinkAllowed(j,e,g,d);var k="";if(f){if(d){k="link_start_allow"}else{k="link_finish_allow"}}else{if(d){k="link_start_deny"}else{k="link_finish_deny"}}c.push(k)}return c.join(" ")};gantt._render_pair=function(c,b,a,d){var e=gantt.getState();if(+a.end_date<=+e.max_date){c.appendChild(d(b+" task_right"))}if(+a.start_date>=+e.min_date){c.appendChild(d(b+" task_left"))}};gantt._render_task_element=function(c){if(!(+c.start_date<+this._max_date&&+c.end_date>+this._min_date)){return false}var g=this._get_task_coord(c);var d=this._pos_from_date(c.end_date);var e=this.config;var i=this._tasks.bar_height;i=Math.min(i,this.config.row_height);var h=Math.floor((this.config.row_height-i)/2);var a=document.createElement("div");var b=Math.round(d-g.x);a.setAttribute(this.config.task_attribute,c.id);a.appendChild(gantt._render_task_content(c,b));a.className=this._combine_item_class("gantt_task_line",this.templates.task_class(c.start_date,c.end_date,c),c.id);a.style.cssText=["left:"+g.x+"px","top:"+(h+g.y)+"px","height:"+i+"px","line-height:"+i+"px","width:"+b+"px"].join(";");var f=this._render_leftside_content(c);if(f){a.appendChild(f)}f=this._render_rightside_content(c);if(f){a.appendChild(f)}if(e.show_progress){this._render_task_progress(c,a,b)}if(e.drag_resize&&!this._is_flex_task(c)){gantt._render_pair(a,"gantt_task_drag",c,function(j){var k=document.createElement("div");k.className=j;return k})}if(e.drag_links){gantt._render_pair(a,"gantt_link_control",c,function(l){var k=document.createElement("div");k.className=l;k.style.cssText=["height:"+i+"px","line-height:"+i+"px"].join(";");var j=document.createElement("div");j.className="gantt_link_point";k.appendChild(j);return k})}return a};gantt._render_side_content=function(b,c,a){if(!c){return null}var e=c(b.start_date,b.end_date,b);if(!e){return null}var d=document.createElement("div");d.className="gantt_side_content "+a;d.innerHTML=e;return d};gantt._render_leftside_content=function(a){var b="gantt_left "+gantt._get_link_crossing_css(true,a);return gantt._render_side_content(a,this.templates.leftside_text,b)};gantt._render_rightside_content=function(a){var b="gantt_right "+gantt._get_link_crossing_css(false,a);return gantt._render_side_content(a,this.templates.rightside_text,b)};gantt._get_conditions=function(a){if(a){return{$source:[gantt.config.links.start_to_start],$target:[gantt.config.links.start_to_start,gantt.config.links.finish_to_start]}}else{return{$source:[gantt.config.links.finish_to_start,gantt.config.links.finish_to_finish],$target:[gantt.config.links.finish_to_finish]}}};gantt._get_link_crossing_css=function(g,b){var d=gantt._get_conditions(g);for(var c in d){var a=b[c];for(var f=0;f<a.length;f++){var e=gantt.getLink(a[f]);for(var h=0;h<d[c].length;h++){if(e.type==d[c][h]){return"gantt_link_crossing"}}}}return""};gantt._render_task_content=function(a,b){var c=document.createElement("div");c.innerHTML=this.templates.task_text(a.start_date,a.end_date,a);c.className="gantt_task_content";c.style.width=b+"px";return c};gantt._render_task_progress=function(b,c,f){var a=b.progress*1||0;f=Math.max(f-2,0);var g=document.createElement("div");var e=Math.round(f*a);g.style.width=e+"px";g.className="gantt_task_progress";g.innerHTML=this.templates.progress_text(b.start_date,b.end_date,b);c.appendChild(g);if(this.config.drag_progress){var d=document.createElement("div");d.style.left=e+"px";d.className="gantt_task_progress_drag";g.appendChild(d);c.appendChild(d)}};gantt._get_line=function(b){var a={second:1,minute:60,hour:60*60,day:60*60*24,week:60*60*24*7,month:60*60*24*30,year:60*60*24*365};return a[b]||0};gantt._date_from_pos=function(a){var f=this._tasks;if(a<0||a>f.full_width){return null}var e=0;var g=0;while(g+f.width[e]<a){e++;g+=f.width[e]}var c=(a-g)/f.width[e];var d=gantt._get_coll_duration(f,f.trace_x[e]);var b=new Date(f.trace_x[e].valueOf()+Math.round(c*d));return b};gantt._pos_from_date=function(b){var d=gantt._day_index_by_date(b);dhtmlx.assert(d>=0,"Invalid day index");var a=Math.floor(d);var f=d%1;var e=0;for(var c=1;c<=a;c++){e+=gantt._tasks.width[c-1]}if(f){if(a<gantt._tasks.width.length){e+=gantt._tasks.width[a]*(f%1)}else{e+=1}}return e};gantt._day_index_by_date=function(a){var d=new Date(a);var c=gantt._tasks.trace_x;if(+d<=this._min_date){return 0}if(+d>=this._max_date){return c.length}for(var b=0;b<c.length-1;b++){if(+d<c[b+1]){break}}return b+((a-c[b])/gantt._get_coll_duration(gantt._tasks,c[b]))};gantt._get_coll_duration=function(b,a){return gantt.date.add(a,b.step,b.unit)-a};gantt._get_y_pos=function(a){var b=this._get_visible_order(a);dhtmlx.assert((b!=-1),"Task index not found");return b*this.config.row_height};gantt._get_task_coord=function(a){return{x:gantt._pos_from_date(a.start_date),y:gantt._get_y_pos(a.id)}};gantt._correct_shift=function(b,a){return b-=((new Date(gantt._min_date)).getTimezoneOffset()-(new Date(b)).getTimezoneOffset())*60000*(a?-1:1)};gantt._scroll_task_area=function(b,a){if(b*1===b){this.$task.scrollLeft=b}if(a*1===a){this.$task_data.scrollTop=a}};gantt._get_mouse_pos=function(b){if(b.pageX||b.pageY){var e={x:b.pageX,y:b.pageY}}var c=_isIE?document.documentElement:document.body;var e={x:b.clientX+c.scrollLeft-c.clientLeft,y:b.clientY+c.scrollTop-c.clientTop};var a=gantt._get_position(gantt.$task_data);e.x=e.x-a.x+gantt.$task_data.scrollLeft;e.y=e.y-a.y+gantt.$task_data.scrollTop;return e};gantt._task_renderer=function(c,b,a){if(!this._task_area_pulls){this._task_area_pulls={}}if(!this._task_area_renderers){this._task_area_renderers={}}if(this._task_area_renderers[c]){return this._task_area_renderers[c]}if(!b){dhtmlx.assert(false,"Invalid renderer call")}this._task_area_renderers[c]={render_item:function(e,d){var f=gantt._task_area_pulls[c];d=d||a;var g=b.call(gantt,e);if(!g){return}if(f[e.id]){this.replace_item(e.id,g)}else{f[e.id]=g;d.appendChild(g)}},render_items:function(f,e){this.rendered=gantt._task_area_pulls[c]={};e=e||a;e.innerHTML="";var d=document.createDocumentFragment();for(var g=0,h=f.length;g<h;g++){this.render_item(f[g],d)}e.appendChild(d)},replace_item:function(d,e){var f=this.rendered[d];if(f&&f.parentNode){f.parentNode.replaceChild(e,f)}this.rendered[d]=e},remove_item:function(d){var e=this.rendered[d];if(e&&e.parentNode){e.parentNode.removeChild(e)}delete this.rendered[d]},change_id:function(e,d){this.rendered[d]=this.rendered[e];delete this.rendered[e]},rendered:this._task_area_pulls[c],node:a};return this._task_area_renderers[c]};gantt.showTask=function(d){var a=this.getTaskNode(d);var c=Math.max(a.offsetLeft-this.config.task_scroll_offset,0);var b=a.offsetTop-(this.$task_data.offsetHeight-this.config.row_height)/2;this._scroll_task_area(c,b)};gantt._pull={};gantt._branches={};gantt._order=[];gantt._lpull={};gantt.load=function(b,c,e){dhtmlx.assert(arguments.length,"Invalid load arguments");this.callEvent("onLoadStart",[]);var d="json",a=null;if(arguments.length>=3){d=c;a=e}else{if(typeof arguments[1]=="string"){d=arguments[1]}else{if(typeof arguments[1]=="function"){a=arguments[1]}}}dhtmlxAjax.get(b,dhtmlx.bind(function(f){this.on_load(f,d);if(typeof a=="function"){a.call(this)}},this))};gantt.parse=function(b,a){this.on_load({xmlDoc:{responseText:b}},a)};gantt.serialize=function(a){a=a||"json";return this[a].serialize()};gantt.on_load=function(d,b){if(!b){b="json"}dhtmlx.assert(this[b],"Invalid data type:'"+b+"'");var a=d.xmlDoc.responseText;var c=this[b].parse(a,d);this._process_loading(c);this.callEvent("onLoadEnd",[])};gantt._process_loading=function(d){if(d.collections){this._load_collections(d.collections)}var b={};var e=d.data;for(var c=0;c<e.length;c++){var a=e[c];this._init_task(a);if(!this.callEvent("onTaskLoading",[b[c]])){continue}b[a.id]=a;if(!this._branches[a.parent]){this._branches[a.parent]=[]}this._branches[a.parent].push(a.id)}dhtmlx.mixin(this._pull,b,true);this._sync_order();for(var c in this._pull){this._pull[c].$level=this._item_level(this._pull[c])}this._init_links(d.links||(d.collections?d.collections.links:[]))};gantt._init_links=function(a){if(a){for(var b=0;b<a.length;b++){var c=this._init_link(a[b]);this._lpull[c.id]=c}}this._sync_links()};gantt._load_collections=function(c){var i=false;for(var h in c){if(c.hasOwnProperty(h)){i=true;var f=c[h];var e=this.serverList[h];if(!e){continue}e.splice(0,e.length);for(var a=0;a<f.length;a++){var d=f[a];var b=dhtmlx.copy(d);b.key=b.value;for(var g in d){if(d.hasOwnProperty(g)){if(g=="value"||g=="label"){continue}b[g]=d[g]}}e.push(b)}}}if(i){this.callEvent("onOptionsLoad",[])}};gantt._sync_order=function(){this._order=[];this._sync_order_item({parent:0,$open:true,$ignore:true,id:0});this._scroll_resize();this._set_sizes()};gantt.attachEvent("onBeforeTaskDisplay",function(b,a){return !a.$ignore});gantt._sync_order_item=function(c){if(c.id&&this.callEvent("onBeforeTaskDisplay",[c.id,c])){this._order.push(c.id)}if(c.$open){var b=this._branches[c.id];if(b){for(var a=0;a<b.length;a++){this._sync_order_item(this._pull[b[a]])}}}};gantt._get_visible_order=function(d){dhtmlx.assert(d,"Invalid argument");var a=this._order;for(var b=0,c=a.length;b<c;b++){if(a[b]==d){return b}}return -1};gantt.eachTask=function(f,c,e){c=c||0;e=e||this;var b=this._branches[c];if(b){for(var a=0;a<b.length;a++){var d=this._pull[b[a]];f.call(e,d);if(this._branches[d.id]){this.eachTask(f,d.id,e)}}}};gantt.json={parse:function(data){dhtmlx.assert(data,"Invalid data");if(typeof data=="string"){if(window.JSON){data=JSON.parse(data)}else{gantt._temp=eval("("+data+")");data=gantt._temp||{};gantt._temp=null}}if(data.dhx_security){dhtmlx.security_key=data.dhx_security}return data},_copyLink:function(b){var c={};for(var a in b){c[a]=b[a]}return c},_copyObject:function(b){var c={};for(var a in b){if(a.charAt(0)=="$"){continue}c[a]=b[a]}c.start_date=gantt.templates.xml_format(c.start_date);if(c.end_date){c.end_date=gantt.templates.xml_format(c.end_date)}return c},serialize:function(){var c=[];var a=[];gantt.eachTask(function(d){c.push(this._copyObject(d))},0,this);for(var b in gantt._lpull){a.push(this._copyLink(gantt._lpull[b]))}return{data:c,links:a}}};gantt.xml={_xmlNodeToJSON:function(d,a){var c={};for(var b=0;b<d.attributes.length;b++){c[d.attributes[b].name]=d.attributes[b].value}if(!a){for(var b=0;b<d.childNodes.length;b++){var e=d.childNodes[b];if(e.nodeType==1){c[e.tagName]=e.firstChild?e.firstChild.nodeValue:""}}if(!c.text){c.text=d.firstChild?d.firstChild.nodeValue:""}}return c},_getCollections:function(n){var g={};var a=n.doXPath("//coll_options");for(var e=0;e<a.length;e++){var l=a[e].getAttribute("for");var f=g[l]=[];var p=n.doXPath(".//item",a[e]);for(var c=0;c<p.length;c++){var m=p[c];var o=m.attributes;var d={key:p[c].getAttribute("value"),label:p[c].getAttribute("label")};for(var b=0;b<o.length;b++){var h=o[b];if(h.nodeName=="value"||h.nodeName=="label"){continue}d[h.nodeName]=h.nodeValue}f.push(d)}}return g},_getXML:function(d,b,c){c=c||"data";if(!b.getXMLTopNode){b=new dtmlXMLLoaderObject(function(){});b.loadXMLString(d)}xml=b.getXMLTopNode(c);if(xml.tagName!=c){throw"Invalid XML data"}var a=xml.getAttribute("dhx_security");if(a){dhtmlx.security_key=a}return b},parse:function(e,a){a=this._getXML(e,a);var d={};var b=d.data=[];xml=a.doXPath("//task");for(var c=0;c<xml.length;c++){b[c]=this._xmlNodeToJSON(xml[c])}d.collections=this._getCollections(a);return d},_copyLink:function(a){return"<item id='"+a.id+"' source='"+a.source+"' target='"+a.target+"' type='"+a.type+"' />"},_copyObject:function(b){var a=gantt.templates.xml_format(b.start_date);var c=gantt.templates.xml_format(b.end_date);return"<task id='"+b.id+"' parent='"+(b.parent||"")+"' start_date='"+a+"' duration='"+b.duration+"' open='"+(!!b.open)+"' progress='"+b.progress+"' end_date='"+c+"'><![CDATA["+b.text+"]]></task>"},serialize:function(){var c=[];var a=[];gantt.eachTask(function(d){c.push(this._copyObject(d))},0,this);for(var b in gantt._lpull){a.push(this._copyLink(gantt._lpull[b]))}return"<data>"+c.join("")+"<coll_options for='links'>"+a.join("")+"</coll_options></data>"}};gantt.oldxml={parse:function(g,a){a=gantt.xml._getXML(g,a,"projects");var f={collections:{links:[]}};var b=f.data=[];xml=a.doXPath("//task");for(var c=0;c<xml.length;c++){b[c]=gantt.xml._xmlNodeToJSON(xml[c]);var d=xml[c].parentNode;if(d.tagName=="project"){b[c].parent="project-"+d.getAttribute("id")}else{b[c].parent=d.parentNode.getAttribute("id")}}xml=a.doXPath("//project");for(var c=0;c<xml.length;c++){var e=gantt.xml._xmlNodeToJSON(xml[c],true);e.id="project-"+e.id;b.push(e)}for(var c=0;c<b.length;c++){var e=b[c];e.start_date=e.startdate||e.est;e.end_date=e.enddate;e.text=e.name;e.duration=e.duration/8;e.open=1;if(!e.duration&&!e.end_date){e.duration=1}if(e.predecessortasks){f.collections.links.push({target:e.id,source:e.predecessortasks,type:gantt.config.links.finish_to_start})}}return f},serialize:function(){webix.message("Serialization to 'old XML' is not implemented")}};gantt.serverList=function(a,b){if(b){return this.serverList[a]=b.slice(0)}return this.serverList[a]=(this.serverList[a]||[])};gantt.getTask=function(a){dhtmlx.assert(this._pull[a]);return this._pull[a]};gantt.getTaskByTime=function(h,g){var e=this._pull,d=[],f=0,b=0;if(!(h||g)){for(var c in e){d.push(e[c])}}else{h=+h||-Infinity;g=+g||Infinity;for(var c in e){var a=e[c];if(+a.start_date<g&&+a.end_date>h){d.push(a)}}}return d};gantt.isTaskExists=function(a){return dhtmlx.defined(this._pull[a])};gantt.isTaskVisible=function(c){if(!this._pull[c]){return false}if(!(+this._pull[c].start_date<+this._max_date&&+this._pull[c].end_date>+this._min_date)){return false}for(var a=0,b=this._order.length;a<b;a++){if(this._order[a]==c){return true}}return false};gantt.updateTask=function(b,a){if(!dhtmlx.defined(a)){a=this.getTask(b)}if(this.callEvent("onBeforeTaskUpdate",[b,a])===false){return false}this._pull[a.id]=a;this._update_parents(a.id);this.refreshTask(a.id);this.callEvent("onAfterTaskUpdate",[b,a]);this._sync_order();this._adjust_scales()};gantt.addTask=function(b,a){if(!dhtmlx.defined(a)){a=b.parent||0}if(!dhtmlx.defined(this._pull[a])){a=0}b.parent=a;b=this._init_task(b);if(this.callEvent("onBeforeTaskAdd",[b.id,b])===false){return false}this._pull[b.id]=b;if(!this._branches[b.parent]){this._branches[b.parent]=[]}this._branches[b.parent].push(b.id);this.refreshData();this.callEvent("onAfterTaskAdd",[b.id,b]);this._adjust_scales();return b.id};gantt.deleteTask=function(a){return this._deleteTask(a)};gantt._deleteTask=function(e,b){var d=this.getTask(e);if(!b&&this.callEvent("onBeforeTaskDelete",[e,d])===false){return false}if(!b&&this._dp){this._dp.setUpdateMode("off")}var a=this._branches[d.id]||[];if(this._selected_task==e){this._selected_task=null}for(var c=0;c<a.length;c++){this._silentStart();this._deleteTask(a[c],true);if(this._dp){this._dp._ganttMode="tasks";this._dp.setUpdated(a[c],true,"deleted")}this._silentEnd()}if(!b&&this._dp){this._dp.setUpdateMode("cell")}while(d.$source.length>0){this.deleteLink(d.$source[0])}while(d.$target.length>0){this.deleteLink(d.$target[0])}delete this._pull[e];delete this._branches[e];this._branch_update(d.parent,e);if(!b){this.callEvent("onAfterTaskDelete",[e,d]);this.refreshData()}return true};gantt.clearAll=function(){this._pull={};this._branches={};this._order=[];this._order_full=[];this._lpull={};this.refreshData();this.callEvent("onClear",[])};gantt.changeTaskId=function(c,a){var b=this._pull[a]=this._pull[c];this._pull[a].id=a;delete this._pull[c];for(var d in this._pull){if(this._pull[d].parent==c){this._pull[d].parent=a}}if(this._lightbox_id==c){this._lightbox_id=a}this._branch_update(b.parent,c,a);this._sync_order();this.callEvent("onTaskIdChange",[c,a])};gantt._branch_update=function(f,c,a){var d=this._branches[f];if(d){var e=[];for(var b=0;b<d.length;b++){if(d[b]!=c){e.push(d[b])}else{if(a){e.push(a)}}}this._branches[f]=e}};gantt._get_duration_unit=function(){return(gantt._get_line(this.config.duration_unit)*1000)||this.config.duration_unit};gantt._init_task=function(a){if(!dhtmlx.defined(a.id)){a.id=dhtmlx.uid()}if(a.start_date){a.start_date=gantt.date.parseDate(a.start_date,"xml_date")}if(a.end_date){a.end_date=gantt.date.parseDate(a.end_date,"xml_date")}var b=this._get_duration_unit();if(a.start_date&&a.duration){a.end_date=new Date(a.start_date.valueOf()+a.duration*b)}gantt._init_task_timing(a);a.$source=[];a.$target=[];a.parent=a.parent||0;a.$open=dhtmlx.defined(a.open)?a.open:false;a.$level=this._item_level(a);return a};gantt._init_task_timing=function(a){a.$no_end=!(a.end_date||a.duration);a.$no_start=!a.start_date};gantt._is_flex_task=function(a){return !!(a.$no_end||a.$no_start)};gantt._update_parents=function(e,c){if(!e){return}var b=this.getTask(e);while(!(b.$no_end||b.$no_start)&&b.parent&&this.isTaskExists(b.parent)){b=this.getTask(b.parent)}if(b.$no_end){var a=0;this.eachTask(function(f){if(+f.end_date>+a){a=new Date(f.end_date)}},b.id);if(a){b.end_date=a}}if(b.$no_start){var d=Infinity;this.eachTask(function(f){if(+f.start_date<+d){d=new Date(f.start_date)}},b.id);if(d!=Infinity){b.start_date=d}}if((b.$no_end||b.$no_start)){this._update_task_duration(b);if(!c){this.refreshTask(b.id,true)}}if(b.parent&&this.isTaskExists(b.parent)){this._update_parents(b.parent,c)}};gantt._round_date=function(b,a,c){var d=new Date(1970,0,1),c=gantt.date.add(d,a,c)-d,g=b-d,f=g%c,e=g-f+Math.round(f/c)*c;return new Date(+d+e)};gantt._round_task_dates=function(a,c,b){a.start_date=this._round_date(+a.start_date,c,b);a.end_date=this._round_date(+a.end_date,c,b);if(a.end_date<=a.start_date){a.end_date=gantt.date.add(a.start_date,c,b)}};gantt._update_task_duration=function(a){if(a.start_date&&a.end_date){a.duration=Math.round((a.end_date-a.start_date)/(this.config.duration_step*this._get_duration_unit()))}};gantt._item_level=function(a){var b=0;while(a.parent){if(!dhtmlx.defined(this._pull[a.parent])){break}a=this._pull[a.parent];b++}return b};gantt.sort=function(f,g,e){var d=!arguments[3];if(!dhtmlx.defined(e)){e=0}if(!dhtmlx.defined(f)){f="order"}var h=(typeof(f)=="string")?(function(k,j){var i=k[f]>j[f];if(g){i=!i}return i?1:-1}):f;var c=this._branches[e];if(c){var a=[];for(var b=c.length-1;b>=0;b--){a[b]=this._pull[c[b]]}a.sort(h);for(var b=0;b<a.length;b++){c[b]=a[b].id;this.sort(f,g,c[b],true)}}if(d){this.refreshData()}};gantt.getNext=function(b){for(var a=0;a<this._order.length-1;a++){if(this._order[a]==b){return this._order[a+1]}}return null};gantt.getPrev=function(b){for(var a=1;a<this._order.length;a++){if(this._order[a]==b){return this._order[a-1]}}return null};gantt._dp_init=function(a){a.setTransactionMode("POST",true);a.serverProcessor+=(a.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true";a._serverProcessor=a.serverProcessor;a.styles={updated:"gantt_updated",inserted:"gantt_inserted",deleted:"gantt_deleted",invalid:"gantt_invalid",error:"gantt_error",clear:""};a._methods=["_row_style","setCellTextStyle","_change_id","_delete_task"];this.attachEvent("onAfterTaskAdd",function(c,b){a._ganttMode="tasks";a.setUpdated(c,true,"inserted")});this.attachEvent("onAfterTaskUpdate",function(c,b){a._ganttMode="tasks";a.setUpdated(c,true)});this.attachEvent("onAfterTaskDelete",function(c,b){a._ganttMode="tasks";a.setUpdated(c,true,"deleted")});this.attachEvent("onAfterLinkUpdate",function(c,b){a._ganttMode="links";a.setUpdated(c,true)});this.attachEvent("onAfterLinkAdd",function(c,b){a._ganttMode="links";a.setUpdated(c,true,"inserted")});this.attachEvent("onAfterLinkDelete",function(c,b){a._ganttMode="links";a.setUpdated(c,true,"deleted")});this.attachEvent("onRowDragEnd",function(c,b){a._ganttMode="tasks";this.getTask(c).target=b;a.setUpdated(c,true,"order")});a.attachEvent("onBeforeDataSending",function(){this.serverProcessor=this._serverProcessor+getUrlSymbol(this._serverProcessor)+"gantt_mode="+this._ganttMode;return true});a._getRowData=dhtmlx.bind(function(g,b){var c;if(a._ganttMode=="tasks"){c=this.isTaskExists(g)?this.getTask(g):{id:g}}else{c=this.isLinkExists(g)?this.getLink(g):{id:g}}var f={};for(var d in c){if(d.substr(0,1)=="$"){continue}var e=c[d];if(e instanceof Date){f[d]=this.templates.xml_format(e)}else{f[d]=e}}if(c.$no_start){c.start_date="";c.duration=""}if(c.$no_end){c.end_date="";c.duration=""}f[a.action_param]=this.getUserData(g,a.action_param);return f},this);this._change_id=dhtmlx.bind(function(c,b){if(a._ganttMode!="tasks"){this.changeLinkId(c,b)}else{this.changeTaskId(c,b)}},this);this._row_style=function(b,e){if(a._ganttMode!="tasks"){return}var c=gantt.getTaskRowNode(b);if(!c){return}if(!e){var d=/ (gantt_updated|gantt_inserted|gantt_deleted|gantt_invalid|gantt_error)/g;c.className=c.className.replace(d,"")}else{c.className+=" "+e}};this._delete_task=function(b,c){};this._dp=a};gantt.getUserData=function(b,a){if(!this.userdata){this.userdata={}}if(this.userdata[b]&&this.userdata[b][a]){return this.userdata[b][a]}return""};gantt.setUserData=function(c,a,b){if(!this.userdata){this.userdata={}}if(!this.userdata[c]){this.userdata[c]={}}this.userdata[c][a]=b};gantt._init_link=function(a){if(!dhtmlx.defined(a.id)){a.id=dhtmlx.uid()}return a};gantt._sync_links=function(){for(var b in this._pull){this._pull[b].$source=[];this._pull[b].$target=[]}for(var b in this._lpull){var a=this._lpull[b];if(this._pull[a.source]){this._pull[a.source].$source.push(b)}if(this._pull[a.target]){this._pull[a.target].$target.push(b)}}};gantt.getLink=function(a){dhtmlx.assert(this._lpull[a],"Link doesn't exist");return this._lpull[a]};gantt.isLinkExists=function(a){return dhtmlx.defined(this._lpull[a])};gantt.addLink=function(a){a=this._init_link(a);if(this.callEvent("onBeforeLinkAdd",[a.id,a])===false){return false}this._lpull[a.id]=a;this._sync_links();this._render_link(a.id);this.callEvent("onAfterLinkAdd",[a.id,a]);return a.id};gantt.updateLink=function(b,a){if(!dhtmlx.defined(a)){a=this.getLink(b)}if(this.callEvent("onBeforeLinkUpdate",[b,a])===false){return false}this._lpull[b]=a;this._sync_links();this._render_link(b);this.callEvent("onAfterLinkUpdate",[b,a]);return true};gantt.deleteLink=function(a){return this._deleteLink(a)};gantt._deleteLink=function(c,a){var b=this.getLink(c);if(!a&&this.callEvent("onBeforeLinkDelete",[c,b])===false){return false}delete this._lpull[c];this._sync_links();this.refreshLink(c);if(!a){this.callEvent("onAfterLinkDelete",[c,b])}return true};gantt.changeLinkId=function(b,a){this._lpull[a]=this._lpull[b];this._lpull[a].id=a;delete this._lpull[b];this._sync_links();this.callEvent("onLinkIdChange",[b,a])};gantt.getChildren=function(a){return dhtmlx.defined(this._branches[a])?this._branches[a]:[]};gantt.hasChild=function(a){return dhtmlx.defined(this._branches[a])};gantt.refreshData=function(){this._sync_order();this._render_data()};gantt._configure=function(a,c){for(var b in c){if(typeof a[b]=="undefined"){a[b]=c[b]}}};gantt._init_skin=function(){if(!gantt.skin){var b=document.getElementsByTagName("link");for(var e=0;e<b.length;e++){var d=b[e].href.match("dhtmlxgantt_([a-z]+).css");if(d){gantt.skin=d[1];break}}}if(!gantt.skin){gantt.skin="terrace"}var a=gantt.skins[gantt.skin];this._configure(gantt.config,a.config);var c=gantt.config.columns;if(c[1]&&typeof c[1].width=="undefined"){c[1].width=a._second_column_width}if(c[2]&&typeof c[2].width=="undefined"){c[2].width=a._third_column_width}if(a._lightbox_template){gantt._lightbox_template=a._lightbox_template}gantt._init_skin=function(){}};gantt.skins={};gantt._lightbox_methods={};gantt._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>";gantt.showLightbox=function(b){if(!b){return}if(!this.callEvent("onBeforeLightbox",[b])){return}var a=this.getLightbox();this._center_lightbox(a);this.showCover();this._fill_lightbox(b,a);this.callEvent("onLightbox",[b])};gantt._get_timepicker_step=function(){if(this.config.round_dnd_dates){var b=gantt._tasks,a=(this._get_line(b.unit)*b.step)/60;if(a>=60*24){a=this.config.time_step}return a}return this.config.time_step};gantt.getLabel=function(e,d){var f=this.config.lightbox.sections;for(var c=0;c<f.length;c++){if(f[c].map_to==e){var b=f[c].options;for(var a=0;a<b.length;a++){if(b[a].key==d){return b[a].label}}}}return""};gantt.getLightbox=function(){if(!this._lightbox){var j=document.createElement("DIV");j.className="dhx_cal_light";var a=this._is_lightbox_timepicker();if(gantt.config.wide_form||a){j.className+=" dhx_cal_light_wide"}if(a){gantt.config.wide_form=true;j.className+=" dhx_cal_light_full"}j.style.visibility="hidden";var c=this._lightbox_template;var f=this.config.buttons_left;for(var b in f){c+="<div class='dhx_btn_set dhx_left_btn_set "+f[b]+"_set'><div dhx_button='1' class='"+f[b]+"'></div><div>"+this.locale.labels[f[b]]+"</div></div>"}f=this.config.buttons_right;for(var b in f){c+="<div class='dhx_btn_set dhx_right_btn_set "+f[b]+"_set' style='float:right;'><div dhx_button='1' class='"+f[b]+"'></div><div>"+this.locale.labels[f[b]]+"</div></div>"}c+="</div>";j.innerHTML=c;if(gantt.config.drag_lightbox){j.firstChild.onmousedown=gantt._ready_to_dnd;j.firstChild.onselectstart=function(){return false};j.firstChild.style.cursor="pointer";gantt._init_dnd_events()}document.body.insertBefore(j,document.body.firstChild);this._lightbox=j;var h=this.config.lightbox.sections;c=this._render_sections(h);var g=j.getElementsByTagName("div");for(var b=0;b<g.length;b++){var e=g[b];if(e.className=="dhx_cal_larea"){e.innerHTML=c;break}}this.resizeLightbox();this._init_lightbox_events(this);j.style.display="none";j.style.visibility="visible"}return this._lightbox};gantt._render_sections=function(d){var c="";for(var b=0;b<d.length;b++){var e=this.form_blocks[d[b].type];if(!e){continue}d[b].id="area_"+dhtmlx.uid();var a="";if(d[b].button){a="<div class='dhx_custom_button' index='"+b+"'><div class='dhx_custom_button_"+d[b].button+"'></div><div>"+this.locale.labels["button_"+d[b].button]+"</div></div>"}if(this.config.wide_form){c+="<div class='dhx_wrap_section'>"}c+="<div id='"+d[b].id+"' class='dhx_cal_lsection'>"+a+this.locale.labels["section_"+d[b].name]+"</div>"+e.render.call(this,d[b]);c+="</div>"}return c};gantt.resizeLightbox=function(){var b=this._lightbox;if(!b){return}var a=b.childNodes[1];a.style.height="0px";a.style.height=a.scrollHeight+"px";b.style.height=a.scrollHeight+this.config.lightbox_additional_height+"px";a.style.height=a.scrollHeight+"px"};gantt._center_lightbox=function(c){if(c){c.style.display="block";var a=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;var d=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;var b=window.innerHeight||document.documentElement.clientHeight;if(a){c.style.top=Math.round(a+Math.max((b-c.offsetHeight)/2,0))+"px"}else{c.style.top=Math.round(Math.max(((b-c.offsetHeight)/2),0)+9)+"px"}if(document.documentElement.scrollWidth>document.body.offsetWidth){c.style.left=Math.round(d+(document.body.offsetWidth-c.offsetWidth)/2)+"px"}else{c.style.left=Math.round((document.body.offsetWidth-c.offsetWidth)/2)+"px"}}};gantt.showCover=function(){this._cover=document.createElement("DIV");this._cover.className="dhx_cal_cover";var b=((document.height!==undefined)?document.height:document.body.offsetHeight);var a=((document.documentElement)?document.documentElement.scrollHeight:0);this._cover.style.height=Math.max(b,a)+"px";document.body.appendChild(this._cover)};gantt._init_lightbox_events=function(){gantt.lightbox_events={};gantt.lightbox_events.dhx_save_btn=function(a){gantt._save_lightbox()};gantt.lightbox_events.dhx_delete_btn=function(a){if(!gantt.callEvent("onLightboxDelete",[gantt._lightbox_id])){return}gantt.$click.buttons["delete"](gantt._lightbox_id)};gantt.lightbox_events.dhx_cancel_btn=function(a){gantt._cancel_lightbox()};gantt.lightbox_events["default"]=function(c,f){if(f.getAttribute("dhx_button")){gantt.callEvent("onLightboxButton",[f.className,f,c])}else{var a,d,b;if(f.className.indexOf("dhx_custom_button")!=-1){if(f.className.indexOf("dhx_custom_button_")!=-1){a=f.parentNode.getAttribute("index");b=f.parentNode.parentNode}else{a=f.getAttribute("index");b=f.parentNode;f=f.firstChild}}if(a){d=gantt.form_blocks[gantt.config.lightbox.sections[a].type];d.button_click(a,f,b,b.nextSibling)}}};dhtmlxEvent(gantt.getLightbox(),"click",function(b){b=b||window.event;var c=b.target?b.target:b.srcElement;if(!c.className){c=c.previousSibling}if(c&&c.className&&c.className.indexOf("dhx_btn_set")===0){c=c.firstChild}if(c&&c.className){var a=dhtmlx.defined(gantt.lightbox_events[c.className])?gantt.lightbox_events[c.className]:gantt.lightbox_events["default"];return a(b,c)}return false});gantt.getLightbox().onkeydown=function(a){switch((a||event).keyCode){case gantt.keys.edit_save:if((a||event).shiftKey){return}gantt._save_lightbox();break;case gantt.keys.edit_cancel:gantt._cancel_lightbox();break;default:break}}};gantt._cancel_lightbox=function(){this.callEvent("onLightboxCancel",[this._lightbox_id,this.$new]);this.hideLightbox()};gantt._save_lightbox=function(){var a=this.getLightboxValues();if(!this.callEvent("onLightboxSave",[this._lightbox_id,a,!!a.$new])){return}if(a.$new){this.addTask(a)}else{dhtmlx.mixin(this.getTask(a.id),a,true);this.updateTask(a.id)}this.refreshData();this.hideLightbox()};gantt.getLightboxValues=function(){var a=dhtmlx.mixin({},this.getTask(this._lightbox_id));var e=this.config.lightbox.sections;for(var c=0;c<e.length;c++){var d=document.getElementById(e[c].id);d=(d?d.nextSibling:d);var f=this.form_blocks[e[c].type];var b=f.get_value.call(this,d,a,e[c]);if(e[c].map_to!="auto"){a[e[c].map_to]=b}}return a};gantt.hideLightbox=function(b){var a=this.getLightbox();if(a){a.style.display="none"}this._lightbox_id=null;this.hideCover();this.callEvent("onAfterLightbox",[])};gantt.hideCover=function(){if(this._cover){this._cover.parentNode.removeChild(this._cover)}this._cover=null};gantt.resetLightbox=function(){if(gantt._lightbox&&!gantt._custom_lightbox){gantt._lightbox.parentNode.removeChild(gantt._lightbox)}gantt._lightbox=null};gantt._fill_lightbox=function(a,f){var b=this.getTask(a);var k=f.getElementsByTagName("span");if(gantt.templates.lightbox_header){k[1].innerHTML="";k[2].innerHTML=gantt.templates.lightbox_header(b.start_date,b.end_date,b)}else{k[1].innerHTML=this.templates.task_time(b.start_date,b.end_date,b);k[2].innerHTML=(this.templates.task_text(b.start_date,b.end_date,b)||"").substr(0,70)}var g=this.config.lightbox.sections;for(var e=0;e<g.length;e++){var j=g[e];var c=document.getElementById(j.id).nextSibling;var d=this.form_blocks[j.type];var h=dhtmlx.defined(b[j.map_to])?b[j.map_to]:j.default_value;d.set_value.call(this,c,h,b,j);if(j.focus){d.focus.call(this,c)}}gantt._lightbox_id=a};gantt.getLightboxSection=function(c){var b=this.config.lightbox.sections;var d=0;for(d;d<b.length;d++){if(b[d].name==c){break}}var g=b[d];if(!this._lightbox){this.getLightbox()}var h=document.getElementById(g.id);var f=h.nextSibling;var a={section:g,header:h,node:f,getValue:function(i){return this.form_blocks[g.type].get_value(f,(i||{}),g)},setValue:function(j,i){return this.form_blocks[g.type].set_value(f,j,(i||{}),g)}};var e=this._lightbox_methods["get_"+g.type+"_control"];return e?e(a):a};gantt._lightbox_methods.get_template_control=function(a){a.control=a.node;return a};gantt._lightbox_methods.get_select_control=function(a){a.control=a.node.getElementsByTagName("select")[0];return a};gantt._lightbox_methods.get_textarea_control=function(a){a.control=a.node.getElementsByTagName("textarea")[0];return a};gantt._lightbox_methods.get_time_control=function(a){a.control=a.node.getElementsByTagName("select");return a};gantt._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",gantt._move_while_dnd);dhtmlxEvent(document.body,"mouseup",gantt._finish_dnd);gantt._init_dnd_events=function(){}};gantt._move_while_dnd=function(c){if(gantt._dnd_start_lb){if(!document.dhx_unselectable){document.body.className+=" dhx_unselectable";document.dhx_unselectable=true}var b=gantt.getLightbox();var a=(c&&c.target)?[c.pageX,c.pageY]:[event.clientX,event.clientY];b.style.top=gantt._lb_start[1]+a[1]-gantt._dnd_start_lb[1]+"px";b.style.left=gantt._lb_start[0]+a[0]-gantt._dnd_start_lb[0]+"px"}};gantt._ready_to_dnd=function(b){var a=gantt.getLightbox();gantt._lb_start=[parseInt(a.style.left,10),parseInt(a.style.top,10)];gantt._dnd_start_lb=(b&&b.target)?[b.pageX,b.pageY]:[event.clientX,event.clientY]};gantt._finish_dnd=function(){if(gantt._lb_start){gantt._lb_start=gantt._dnd_start_lb=false;document.body.className=document.body.className.replace(" dhx_unselectable","");document.dhx_unselectable=false}};gantt._focus=function(b,a){if(b&&b.focus){if(gantt.config.touch){}else{if(a&&b.select){b.select()}b.focus()}}};gantt.form_blocks={getTimePicker:function(l){var d=l.time_format;if(!d){var d=["%Y","%m","%d"];if(gantt._get_line(gantt._tasks.unit)<gantt._get_line("day")){d.push("%H:%i")}}l._time_format_order={size:0};var j=this.config;var c=this.date.date_part(new Date(gantt._min_date.valueOf()));var o=24*60,g=0;if(gantt.config.limit_time_select){o=60*j.last_hour+1;g=60*j.first_hour;c.setHours(j.first_hour)}var h="";for(var a=0;a<d.length;a++){var n=d[a];if(a>0){h+=" "}switch(n){case"%Y":l._time_format_order[2]=a;l._time_format_order.size++;h+="<select>";var k=c.getFullYear()-5;for(var f=0;f<10;f++){h+="<option value='"+(k+f)+"'>"+(k+f)+"</option>"}h+="</select> ";break;case"%m":l._time_format_order[1]=a;l._time_format_order.size++;h+="<select>";for(var f=0;f<12;f++){h+="<option value='"+f+"'>"+this.locale.date.month_full[f]+"</option>"}h+="</select>";break;case"%d":l._time_format_order[0]=a;l._time_format_order.size++;h+="<select>";for(var f=1;f<32;f++){h+="<option value='"+f+"'>"+f+"</option>"}h+="</select>";break;case"%H:%i":var o=24*60,g=0;l._time_format_order[3]=a;l._time_format_order.size++;h+="<select>";var f=g;var b=c.getDate();l._time_values=[];while(f<o){var e=this.templates.time_picker(c);h+="<option value='"+f+"'>"+e+"</option>";l._time_values.push(f);c.setTime(c.valueOf()+this._get_timepicker_step()*60*1000);var m=(c.getDate()!=b)?1:0;f=m*24*60+c.getHours()*60+c.getMinutes()}h+="</select>";break;default:break}}return h},_fill_lightbox_select:function(e,c,g,f,a){e[c+f[0]].value=g.getDate();e[c+f[1]].value=g.getMonth();e[c+f[2]].value=g.getFullYear();if(dhtmlx.defined(f[3])){var b=g.getHours()*60+g.getMinutes();b=Math.round(b/gantt._get_timepicker_step())*gantt._get_timepicker_step();e[c+f[3]].value=b}},template:{render:function(b){var a=(b.height||"30")+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+a+";'></div>"},set_value:function(c,d,b,a){c.innerHTML=d||""},get_value:function(c,b,a){return c.innerHTML||""},focus:function(a){}},textarea:{render:function(b){var a=(b.height||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+a+";'><textarea></textarea></div>"},set_value:function(b,c,a){b.firstChild.value=c||""},get_value:function(b,a){return b.firstChild.value},focus:function(c){var b=c.firstChild;gantt._focus(b,true)}},select:{render:function(d){var a=(d.height||"23")+"px";var c="<div class='dhx_cal_ltext' style='height:"+a+";'><select style='width:100%;'>";for(var b=0;b<d.options.length;b++){c+="<option value='"+d.options[b].key+"'>"+d.options[b].label+"</option>"}c+="</select></div>";return c},set_value:function(c,e,b,d){var a=c.firstChild;if(!a._dhx_onchange&&d.onchange){a.onchange=d.onchange;a._dhx_onchange=true}if(typeof e=="undefined"){e=(a.options[0]||{}).value}a.value=e||""},get_value:function(b,a){return b.firstChild.value},focus:function(c){var b=c.firstChild;gantt._focus(b,true)}},time:{render:function(b){var c=this.form_blocks.getTimePicker.call(this,b);var a="<div style='height:30px;padding-top:0px;font-size:inherit;text-align:center;' class='dhx_section_time'>"+c+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+c+"</div>";return a},set_value:function(c,j,h,b){var g=this.config;var k=c.getElementsByTagName("select");var a=b._time_format_order;var d=b._time_format_size;if(g.auto_end_date&&g.event_duration){function f(){var i=new Date(k[a[2]].value,k[a[1]].value,k[a[0]].value,0,0);var l=new Date(i.getTime()+(gantt.config.event_duration*60*1000));this.form_blocks._fill_lightbox_select(k,a.size,l,a,g)}for(var e=0;e<4;e++){k[e].onchange=f}}this.form_blocks._fill_lightbox_select(k,0,h.start_date,a,g);this.form_blocks._fill_lightbox_select(k,a.size,h.end_date,a,g)},get_value:function(f,e,b){var d=f.getElementsByTagName("select");var h=b._time_format_order;var a=0,c=0;if(dhtmlx.defined(h[3])){var g=parseInt(d[h[3]].value,10);a=Math.floor(g/60);c=g%60}e.start_date=new Date(d[h[2]].value,d[h[1]].value,d[h[0]].value,a,c);a=c=0;if(dhtmlx.defined(h[3])){var g=parseInt(d[h.size+h[3]].value,10);a=Math.floor(g/60);c=g%60}e.end_date=new Date(d[h[2]+h.size].value,d[h[1]+h.size].value,d[h[0]+h.size].value,a,c);if(e.end_date<=e.start_date){e.end_date=gantt.date.add(e.start_date,gantt._get_timepicker_step(),"minute")}return{start_date:new Date(e.start_date),end_date:new Date(e.end_date)}},focus:function(a){gantt._focus(a.getElementsByTagName("select")[0])}},duration:{render:function(c){var e=this.form_blocks.getTimePicker.call(this,c);e="<div class='dhx_time_selects'>"+e+"</div>";var a=this.locale.labels[this._tasks.unit+"s"];var d="<div class='dhx_gantt_duration'><input type='button' class='dhx_gantt_duration_dec' value='-'><input type='text' value='5' class='dhx_gantt_duration_value'><input type='button' class='dhx_gantt_duration_inc' value='+'> "+a+" <span></span></div>";var b="<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+e+" "+d+"</div>";return b},set_value:function(e,n,l,c){var j=this.config;var o=e.getElementsByTagName("select");var i=e.getElementsByTagName("input");var g=i[1];var h=[i[0],i[2]];var k=e.getElementsByTagName("span")[0];var b=c._time_format_order;function f(){var p=gantt.form_blocks.duration._get_start_date.call(gantt,e,c);var q=gantt.form_blocks.duration._get_duration.call(gantt,e,c);var r=gantt.date.add(p,q,gantt._tasks.unit);k.innerHTML=gantt.templates.task_date(r)}function a(p){var q=g.value;q=parseInt(q,10);if(window.isNaN(q)){q=0}q+=p;if(q<1){q=1}g.value=q;f()}h[0].onclick=dhtmlx.bind(function(){a(-1*this.config.duration_step)},this);h[1].onclick=dhtmlx.bind(function(){a(1*this.config.duration_step)},this);o[0].onchange=f;o[1].onchange=f;o[2].onchange=f;if(o[3]){o[3].onchange=f}g.onkeydown=dhtmlx.bind(function(q){q=q||window.event;var p=(q.charCode||q.keyCode||q.which);if(p==40){a(-1*this.config.duration_step);return false}if(p==38){a(1*this.config.duration_step);return false}window.setTimeout(function(r){f()},1)},this);g.onchange=dhtmlx.bind(function(p){f()},this);this.form_blocks._fill_lightbox_select(o,0,l.start_date,b,j);var d;var m=gantt._tasks.unit;if(!l.end_date){d=l.duration}else{d=(l.end_date.valueOf()-l.start_date.valueOf())/(this._get_line(m)*1000)}d=Math.round(d);g.value=d;f()},_get_start_date:function(e,b){var d=e.getElementsByTagName("select");var g=b._time_format_order;var a=0;var c=0;if(dhtmlx.defined(g[3])){var f=parseInt(d[g[3]].value,10);a=Math.floor(f/60);c=f%60}return new Date(d[g[2]].value,d[g[1]].value,d[g[0]].value,a,c)},_get_duration:function(b,a){var c=b.getElementsByTagName("input")[1];c=parseInt(c.value,10);if(window.isNaN(c)){c=1}if(c<0){c*=-1}return c},get_value:function(c,b,a){b.start_date=this.form_blocks.duration._get_start_date(c,a);var d=this.form_blocks.duration._get_duration(c,a);b.end_date=this.date.add(b.start_date,d,this._tasks.unit);b.duration=d;return{start_date:new Date(b.start_date),end_date:new Date(b.end_date)}},focus:function(a){gantt._focus(a.getElementsByTagName("select")[0])}}};gantt._is_lightbox_timepicker=function(){var b=this.config.lightbox.sections;for(var a=0;a<b.length;a++){if(b[a].name=="time"&&b[a].type=="time"){return true}}return false};gantt._dhtmlx_confirm=function(c,d,e,a){if(!c){return e()}var b={text:c};if(d){b.title=d}if(a){b.ok=a}if(e){b.callback=function(f){if(f){e()}}}dhtmlx.confirm(b)};function dataProcessor(a){this.serverProcessor=a;this.action_param="!nativeeditor_status";this.object=null;this.updatedRows=[];this.autoUpdate=true;this.updateMode="cell";this._tMode="GET";this.post_delim="_";this._waitMode=0;this._in_progress={};this._invalid={};this.mandatoryFields=[];this.messages=[];this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"};this.enableUTFencoding(true);dhtmlxEventable(this);return this}dataProcessor.prototype={setTransactionMode:function(b,a){this._tMode=b;this._tSend=a},escape:function(a){if(this._utf){return encodeURIComponent(a)}else{return escape(a)}},enableUTFencoding:function(a){this._utf=convertStringToBoolean(a)},setDataColumns:function(a){this._columns=(typeof a=="string")?a.split(","):a},getSyncState:function(){return !this.updatedRows.length},enableDataNames:function(a){this._endnm=convertStringToBoolean(a)},enablePartialDataSend:function(a){this._changed=convertStringToBoolean(a)},setUpdateMode:function(b,a){this.autoUpdate=(b=="cell");this.updateMode=b;this.dnd=a},ignore:function(b,a){this._silent_mode=true;b.call(a||window);this._silent_mode=false},setUpdated:function(d,c,e){if(this._silent_mode){return}var b=this.findRow(d);e=e||"updated";var a=this.obj.getUserData(d,this.action_param);if(a&&e=="updated"){e=a}if(c){this.set_invalid(d,false);this.updatedRows[b]=d;this.obj.setUserData(d,this.action_param,e);if(this._in_progress[d]){this._in_progress[d]="wait"}}else{if(!this.is_invalid(d)){this.updatedRows.splice(b,1);this.obj.setUserData(d,this.action_param,"")}}if(!c){this._clearUpdateFlag(d)}this.markRow(d,c,e);if(c&&this.autoUpdate){this.sendData(d)}},_clearUpdateFlag:function(a){},markRow:function(f,c,e){var d="";var b=this.is_invalid(f);if(b){d=this.styles[b];c=true}if(this.callEvent("onRowMark",[f,c,e,b])){d=this.styles[c?e:"clear"]+d;this.obj[this._methods[0]](f,d);if(b&&b.details){d+=this.styles[b+"_cell"];for(var a=0;a<b.details.length;a++){if(b.details[a]){this.obj[this._methods[1]](f,a,d)}}}}},getState:function(a){return this.obj.getUserData(a,this.action_param)},is_invalid:function(a){return this._invalid[a]},set_invalid:function(c,b,a){if(a){b={value:b,details:a,toString:function(){return this.value.toString()}}}this._invalid[c]=b},checkBeforeUpdate:function(a){return true},sendData:function(a){if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)){return}if(this.obj.editStop){this.obj.editStop()}if(typeof a=="undefined"||this._tSend){return this.sendAllData()}if(this._in_progress[a]){return false}this.messages=[];if(!this.checkBeforeUpdate(a)&&this.callEvent("onValidationError",[a,this.messages])){return false}this._beforeSendData(this._getRowData(a),a)},_beforeSendData:function(a,b){if(!this.callEvent("onBeforeUpdate",[b,this.getState(b),a])){return false}this._sendData(a,b)},serialize:function(d,e){if(typeof d=="string"){return d}if(typeof e!="undefined"){return this.serialize_one(d,"")}else{var a=[];var c=[];for(var b in d){if(d.hasOwnProperty(b)){a.push(this.serialize_one(d[b],b+this.post_delim));c.push(b)}}a.push("ids="+this.escape(c.join(",")));if(dhtmlx.security_key){a.push("dhx_security="+dhtmlx.security_key)}return a.join("&")}},serialize_one:function(d,b){if(typeof d=="string"){return d}var a=[];for(var c in d){if(d.hasOwnProperty(c)){a.push(this.escape((b||"")+c)+"="+this.escape(d[c]))}}return a.join("&")},_sendData:function(b,c){if(!b){return}if(!this.callEvent("onBeforeDataSending",c?[c,this.getState(c),b]:[null,null,b])){return false}if(c){this._in_progress[c]=(new Date()).valueOf()}var a=new dtmlXMLLoaderObject(this.afterUpdate,this,true);var d=this.serverProcessor+(this._user?(getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&")):"");if(this._tMode!="POST"){a.loadXML(d+((d.indexOf("?")!=-1)?"&":"?")+this.serialize(b,c))}else{a.loadXML(d,true,this.serialize(b,c))}this._waitMode++},sendAllData:function(){if(!this.updatedRows.length){return}this.messages=[];var b=true;for(var a=0;a<this.updatedRows.length;a++){b&=this.checkBeforeUpdate(this.updatedRows[a])}if(!b&&!this.callEvent("onValidationError",["",this.messages])){return false}if(this._tSend){this._sendData(this._getAllData())}else{for(var a=0;a<this.updatedRows.length;a++){if(!this._in_progress[this.updatedRows[a]]){if(this.is_invalid(this.updatedRows[a])){continue}this._beforeSendData(this._getRowData(this.updatedRows[a]),this.updatedRows[a]);if(this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2)){return}}}}},_getAllData:function(d){var b={};var a=false;for(var c=0;c<this.updatedRows.length;c++){var e=this.updatedRows[c];if(this._in_progress[e]||this.is_invalid(e)){continue}if(!this.callEvent("onBeforeUpdate",[e,this.getState(e)])){continue}b[e]=this._getRowData(e,e+this.post_delim);a=true;this._in_progress[e]=(new Date()).valueOf()}return a?b:null},setVerificator:function(b,a){this.mandatoryFields[b]=a||(function(c){return(c!="")})},clearVerificator:function(a){this.mandatoryFields[a]=false},findRow:function(b){var a=0;for(a=0;a<this.updatedRows.length;a++){if(b==this.updatedRows[a]){break}}return a},defineAction:function(a,b){if(!this._uActions){this._uActions=[]}this._uActions[a]=b},afterUpdateCallback:function(b,g,f,e){var a=b;var d=(f!="error"&&f!="invalid");if(!d){this.set_invalid(b,f)}if((this._uActions)&&(this._uActions[f])&&(!this._uActions[f](e))){return(delete this._in_progress[a])}if(this._in_progress[a]!="wait"){this.setUpdated(b,false)}var c=b;switch(f){case"inserted":case"insert":if(g!=b){this.obj[this._methods[2]](b,g);b=g}break;case"delete":case"deleted":this.obj.setUserData(b,this.action_param,"true_deleted");this.obj[this._methods[3]](b);delete this._in_progress[a];return this.callEvent("onAfterUpdate",[b,f,g,e]);break}if(this._in_progress[a]!="wait"){if(d){this.obj.setUserData(b,this.action_param,"")}delete this._in_progress[a]}else{delete this._in_progress[a];this.setUpdated(g,true,this.obj.getUserData(b,this.action_param))}this.callEvent("onAfterUpdate",[c,f,g,e])},afterUpdate:function(k,o,m,l,j){j.getXMLTopNode("data");if(!j.xmlDoc.responseXML){return}var n=j.doXPath("//data/action");for(var g=0;g<n.length;g++){var h=n[g];var f=h.getAttribute("type");var a=h.getAttribute("sid");var e=h.getAttribute("tid");k.afterUpdateCallback(a,e,f,h)}k.finalizeUpdate()},finalizeUpdate:function(){if(this._waitMode){this._waitMode--}if((this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length){this.sendData()}this.callEvent("onAfterUpdateFinish",[]);if(!this.updatedRows.length){this.callEvent("onFullSync",[])}},init:function(a){this.obj=a;if(this.obj._dp_init){this.obj._dp_init(this)}},setOnAfterUpdate:function(a){this.attachEvent("onAfterUpdate",a)},enableDebug:function(a){},setOnBeforeUpdateHandler:function(a){this.attachEvent("onBeforeDataSending",a)},
/*! starts autoupdate mode
		@param interval
			time interval for sending update requests
	*/
setAutoUpdate:function(c,b){c=c||2000;this._user=b||(new Date()).valueOf();this._need_update=false;this._loader=null;this._update_busy=false;this.attachEvent("onAfterUpdate",function(d,f,g,e){this.afterAutoUpdate(d,f,g,e)});this.attachEvent("onFullSync",function(){this.fullSync()});var a=this;window.setInterval(function(){a.loadUpdate()},c)},
/*! process updating request answer
		if status == collision version is depricated
		set flag for autoupdating immidiatly
	*/
afterAutoUpdate:function(a,c,d,b){if(c=="collision"){this._need_update=true;return false}else{return true}},
/*! callback function for onFillSync event
		call update function if it's need
	*/
fullSync:function(){if(this._need_update==true){this._need_update=false;this.loadUpdate()}return true},
/*! sends query to the server and call callback function
	*/
getUpdates:function(a,b){if(this._update_busy){return false}else{this._update_busy=true}this._loader=this._loader||new dtmlXMLLoaderObject(true);this._loader.async=true;this._loader.waitCall=b;this._loader.loadXML(a)},
/*! returns xml node value
		@param node
			xml node
	*/
_v:function(a){if(a.firstChild){return a.firstChild.nodeValue}return""},
/*! returns values array of xml nodes array
		@param arr
			array of xml nodes
	*/
_a:function(a){var c=[];for(var b=0;b<a.length;b++){c[b]=this._v(a[b])}return c},
/*! loads updates and processes them
	*/
loadUpdate:function(){var b=this;var a=this.obj.getUserData(0,"version");var c=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+a].join("&");c=c.replace("editing=true&","");this.getUpdates(c,function(){var f=b._loader.doXPath("//userdata");b.obj.setUserData(0,"version",b._v(f[0]));var d=b._loader.doXPath("//update");if(d.length){b._silent_mode=true;for(var g=0;g<d.length;g++){var e=d[g].getAttribute("status");var j=d[g].getAttribute("id");var h=d[g].getAttribute("parent");switch(e){case"inserted":b.callEvent("insertCallback",[d[g],j,h]);break;case"updated":b.callEvent("updateCallback",[d[g],j,h]);break;case"deleted":b.callEvent("deleteCallback",[d[g],j,h]);break}}b._silent_mode=false}b._update_busy=false;b=null})}};dhtmlx.assert=function(a,b){if(!a){dhtmlx.message({type:"error",text:b,expire:-1})}};gantt.init=function(a,c,b){if(c&&b){this.config.start_date=this._min_date=new Date(c);this.config.end_date=this._max_date=new Date(b)}this._init_skin();if(!this.config.scroll_size){this.config.scroll_size=this._detectScrollSize()}this._reinit(a);this.attachEvent("onLoadEnd",this.render);dhtmlxEvent(window,"resize",this._on_resize);this.init=function(d){if(this.$container){this.$container.innerHTML=""}this._reinit(d)};this.callEvent("onGanttReady",[])};gantt._reinit=function(a){this._init_html_area(a);this._set_sizes();this._task_area_pulls={};this._task_area_renderers={};this._init_touch_events();this._init_templates();this._init_grid();this._init_tasks();this.render();dhtmlxEvent(this.$container,"click",this._on_click);dhtmlxEvent(this.$container,"dblclick",this._on_dblclick);dhtmlxEvent(this.$container,"mousemove",this._on_mousemove);dhtmlxEvent(this.$container,"contextmenu",this._on_contextmenu)};gantt._init_html_area=function(b){if(typeof b=="string"){this._obj=document.getElementById(b)}else{this._obj=b}dhtmlx.assert(this._obj,"Invalid html container: "+b);var a="<div class='gantt_container'><div class='gantt_grid'></div><div class='gantt_task'></div>";a+="<div class='gantt_ver_scroll'><div></div></div><div class='gantt_hor_scroll'><div></div></div></div>";this._obj.innerHTML=a;this.$container=this._obj.firstChild;var c=this.$container.childNodes;this.$grid=c[0];this.$task=c[1];this.$scroll_ver=c[2];this.$scroll_hor=c[3];this.$grid.innerHTML="<div class='gantt_grid_scale'></div><div class='gantt_grid_data'></div>";this.$grid_scale=this.$grid.childNodes[0];this.$grid_data=this.$grid.childNodes[1];this.$task.innerHTML="<div class='gantt_task_scale'></div><div class='gantt_data_area'><div class='gantt_task_bg'></div><div class='gantt_links_area'></div><div class='gantt_bars_area'></div></div>";this.$task_scale=this.$task.childNodes[0];this.$task_data=this.$task.childNodes[1];this.$task_bg=this.$task_data.childNodes[0];this.$task_links=this.$task_data.childNodes[1];this.$task_bars=this.$task_data.childNodes[2]};gantt.$click={buttons:{edit:function(a){gantt.showLightbox(a)},"delete":function(c){var a=gantt.locale.labels.confirm_deleting;var b=gantt.locale.labels.confirm_deleting_title;gantt._dhtmlx_confirm(a,b,function(){gantt.deleteTask(c);gantt.hideLightbox()})}}};gantt._set_sizes=function(){this._x=this._obj.clientWidth;this._y=this._obj.clientHeight;this.$grid.style.height=this.$task.style.height=(this._y-this.$scroll_hor.offsetHeight-2)+"px";this.$grid_data.style.height=this.$task_data.style.height=(this._y-(this.config.scale_height||0)-this.$scroll_hor.offsetHeight-2)+"px";this.$grid.style.width=(this.config.grid_width-1)+"px";this.$grid_data.style.width=(this.config.grid_width-1)+"px";this.$task.style.width=(this._x-this.config.grid_width-2)+"px"};gantt.getScrollState=function(){return{x:this.$task.scrollLeft,y:this.$task_data.scrollTop}};gantt.scrollTo=function(b,a){if(b!==null){this.$task.scrollLeft=b}if(a!==null){this.$task_data.scrollTop=a}};gantt._on_resize=gantt.setSizes=function(){gantt._set_sizes();gantt._render_scroll()};gantt.render=function(){this._render_grid();this._render_tasks_scales();this._render_scroll();this._on_resize();this._render_data();if(this.config.initial_scroll){var a=(this._order[0]||0);if(a){this.showTask(a)}}};gantt._render_scroll=function(){this._scroll_resize();var a=this;dhtmlxEvent(this.$scroll_hor,"scroll",function(){if(gantt._touch_scroll_active){return}var b=a.$scroll_hor.scrollLeft;a._scroll_task_area(b)});dhtmlxEvent(this.$scroll_ver,"scroll",function(){if(gantt._touch_scroll_active){return}var b=a.$scroll_ver.scrollTop;a.$grid_data.scrollTop=b;a._scroll_task_area(null,b)});dhtmlxEvent(this.$task,"scroll",function(){var b=a.$task.scrollLeft;a.$scroll_hor.scrollLeft=b});dhtmlxEvent(this.$task_data,"scroll",function(){var b=a.$task_data.scrollTop;a.$scroll_ver.scrollTop=a.$grid_data.scrollTop=b});dhtmlxEvent(this.$container,"mousewheel",function(f){if(f.wheelDeltaX){var b=f.wheelDeltaX/-40;var d=a.$task.scrollLeft+b*30;a._scroll_task_area(d,null);a.$scroll_hor.scrollTop=c}else{var b=f.wheelDelta/-40;if(typeof f.wheelDelta=="undefined"){b=f.detail}var c=a.$grid_data.scrollTop+b*30;a._scroll_task_area(null,c);a.$scroll_ver.scrollTop=c}if(f.preventDefault){f.preventDefault()}f.cancelBubble=true;return false});this._render_scroll=this._scroll_resize};gantt._scroll_resize=function(){var f=this.config.grid_width;var b=this._x-f;var g=this._y-this.config.scale_height;var d=this.$task_data.offsetWidth-this.config.scroll_size;var a=this.config.row_height*this._order.length;var c=(d>b);var e=(a>g);this.$scroll_hor.style.display=c?"block":"none";this.$scroll_hor.style.height=(c?this.config.scroll_size:0)+"px";this.$scroll_hor.style.width=(this._x-(e?this.config.scroll_size:2))+"px";this.$scroll_hor.firstChild.style.width=(d+f+this.config.scroll_size+2)+"px";this.$scroll_ver.style.display=e?"block":"none";this.$scroll_ver.style.width=(e?this.config.scroll_size:0)+"px";this.$scroll_ver.style.height=(this._y-(c?this.config.scroll_size:0)-this.config.scale_height)+"px";this.$scroll_ver.style.top=this.config.scale_height+"px";this.$scroll_ver.firstChild.style.height=(this.config.scale_height+a)+"px"};gantt.locate=function(c){var a=gantt._get_target_node(c);if(a.className=="gantt_task_cell"){return null}var b=arguments[1]||this.config.task_attribute;while(a){if(a.getAttribute){var d=a.getAttribute(b);if(d){return d}}a=a.parentNode}return null};gantt._get_target_node=function(b){var a;if(b.tagName){a=b}else{b=b||window.event;a=b.target||b.srcElement}return a};gantt._trim=function(b){var a=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};return a.apply(b)};gantt._locate_css=function(g,d,i){if(i===undefined){i=true}var a=gantt._get_target_node(g);var f="";var h=false;while(a){f=a.className;if(f){var b=f.indexOf(d);if(b>=0){if(!i){return a}var c=(b===0)||(!gantt._trim(f.charAt(b-1)));var j=((b+d.length>=f.length))||(!gantt._trim(f.charAt(b+d.length)));if(c&&j){return a}}}a=a.parentNode}return null};gantt._locateHTML=function(c,b){var a=gantt._get_target_node(c);b=b||this.config.task_attribute;while(a){if(a.getAttribute){var d=a.getAttribute(b);if(d){return a}}a=a.parentNode}return null};gantt.getTaskRowNode=function(e){var b=this.$grid_data.childNodes;var c=this.config.task_attribute;for(var a=0;a<b.length;a++){if(b[a].getAttribute){var d=b[a].getAttribute(c);if(d==e){return b[a]}}}return null};gantt.getState=function(){return{drag_id:this._tasks_dnd.drag.id,drag_mode:this._tasks_dnd.drag.mode,selected_task:this._selected_task,min_date:this._min_date,max_date:this._max_date,lightbox:this._lightbox_id}};gantt._checkTimeout=function(b,a){if(!a){return true}var c=1000/a;if(c<1){return true}if(b._on_timeout){return false}setTimeout(function(){delete b._on_timeout},c);return b._on_timeout=true};gantt.selectTask=function(a){if(!this.config.select_task){return}if(a){if(this._selected_task==a){return this._selected_task}if(!this.callEvent("onBeforeTaskSelected",[a])){return false}this.unselectTask();this._selected_task=a;this.refreshTask(a);this.callEvent("onTaskSelected",[a])}return this._selected_task};gantt.unselectTask=function(){var a=this._selected_task;if(!a){return}this._selected_task=null;this.refreshTask(a);this.callEvent("onTaskUnselected",[a])};gantt.getSelectedId=function(){return dhtmlx.defined(this._selected_task)?this._selected_task:null};gantt.date={init:function(){var c=gantt.locale.date.month_short;var b=gantt.locale.date.month_short_hash={};for(var a=0;a<c.length;a++){b[c[a]]=a}var c=gantt.locale.date.month_full;var b=gantt.locale.date.month_full_hash={};for(var a=0;a<c.length;a++){b[c[a]]=a}},date_part:function(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);if(a.getHours()){a.setTime(a.getTime()+60*60*1000*(24-a.getHours()))}return a},time_part:function(a){return(a.valueOf()/1000-a.getTimezoneOffset()*60)%86400},week_start:function(b){var a=b.getDay();if(gantt.config.start_on_monday){if(a===0){a=6}else{a--}}return this.date_part(this.add(b,-1*a,"day"))},month_start:function(a){a.setDate(1);return this.date_part(a)},year_start:function(a){a.setMonth(0);return this.month_start(a)},day_start:function(a){return this.date_part(a)},hour_start:function(b){var a=b.getHours();this.day_start(b);b.setHours(a);return b},minute_start:function(a){var b=a.getMinutes();this.hour_start(a);a.setMinutes(b);return a},add:function(b,c,d){if(isNaN(b)){b=new Date();b.setFullYear(2015,1,1)}if(isNaN(c)){c=1}var a=new Date(b.valueOf());switch(d){case"week":c*=7;case"day":a.setDate(a.getDate()+c);if(!b.getHours()&&a.getHours()){a.setTime(a.getTime()+60*60*1000*(24-a.getHours()))}break;case"month":a.setMonth(a.getMonth()+c);break;case"year":a.setYear(a.getFullYear()+c);break;case"hour":a.setHours(a.getHours()+c);break;case"minute":a.setMinutes(a.getMinutes()+c);break;default:return gantt.date["add_"+d](b,c,d)}return a},to_fixed:function(a){if(a<10){return"0"+a}return a},copy:function(a){return new Date(a.valueOf())},date_to_str:function(b,a){b=b.replace(/%[a-zA-Z]/g,function(c){switch(c){case"%d":return'"+gantt.date.to_fixed(date.getDate())+"';case"%m":return'"+gantt.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+gantt.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+gantt.locale.date.day_short[date.getDay()]+"';case"%l":return'"+gantt.locale.date.day_full[date.getDay()]+"';case"%M":return'"+gantt.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+gantt.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+gantt.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+gantt.date.to_fixed(date.getHours())+"';case"%i":return'"+gantt.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+gantt.date.to_fixed(date.getSeconds())+"';case"%W":return'"+gantt.date.to_fixed(gantt.date.getISOWeek(date))+"';default:return c}});if(a){b=b.replace(/date\.get/g,"date.getUTC")}return new Function("date",'return "'+b+'";')},str_to_date:function(e,c){var f="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);";var a=e.match(/%[a-zA-Z]/g);for(var b=0;b<a.length;b++){switch(a[b]){case"%j":case"%d":f+="set[2]=temp["+b+"]||1;";break;case"%n":case"%m":f+="set[1]=(temp["+b+"]||1)-1;";break;case"%y":f+="set[0]=temp["+b+"]*1+(temp["+b+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":f+="set[3]=temp["+b+"]||0;";break;case"%i":f+="set[4]=temp["+b+"]||0;";break;case"%Y":f+="set[0]=temp["+b+"]||0;";break;case"%a":case"%A":f+="set[3]=set[3]%12+((temp["+b+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":f+="set[5]=temp["+b+"]||0;";break;case"%M":f+="set[1]=gantt.locale.date.month_short_hash[temp["+b+"]]||0;";break;case"%F":f+="set[1]=gantt.locale.date.month_full_hash[temp["+b+"]]||0;";break;default:break}}var d="set[0],set[1],set[2],set[3],set[4],set[5]";if(c){d=" Date.UTC("+d+")"}return new Function("date","var set=[0,0,1,0,0,0]; "+f+" return new Date("+d+");")},getISOWeek:function(c){if(!c){return false}var b=c.getDay();if(b===0){b=7}var d=new Date(c.valueOf());d.setDate(c.getDate()+(4-b));var a=d.getFullYear();var f=Math.round((d.getTime()-new Date(a,0,1).getTime())/86400000);var e=1+Math.floor(f/7);return e},getUTCISOWeek:function(a){return this.getISOWeek(a)},convert_to_utc:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())},parseDate:function(a,b){if(typeof(a)=="string"){if(dhtmlx.defined(b)){if(typeof(b)=="string"){b=dhtmlx.defined(gantt.templates[b])?gantt.templates[b]:gantt.date.str_to_date(b)}else{b=gantt.templates.xml_date}}a=b(a)}return a}};if(!gantt.config){gantt.config={}}if(!gantt.config){gantt.config={}}if(!gantt.templates){gantt.templates={}}(function(){dhtmlx.mixin(gantt.config,{links:{finish_to_start:"0",start_to_start:"1",finish_to_finish:"2"},duration_unit:"day",min_duration:60*60*1000,xml_date:"%Y-%m-%d %H:%i",api_date:"%Y-%m-%d %H:%i",start_on_monday:true,server_utc:false,show_progress:true,fit_tasks:false,select_task:true,readonly:false,date_grid:"%Y-%m-%d",drag_links:true,drag_progress:true,drag_resize:true,drag_move:true,drag_mode:{resize:"resize",progress:"progress",move:"move",ignore:"ignore"},round_dnd_dates:true,link_wrapper_width:20,autofit:true,columns:[{name:"text",tree:true,width:"*"},{name:"start_date",align:"center"},{name:"duration",align:"center"},{name:"add",width:"44"}],step:1,scale_unit:"day",subscales:[],time_step:60,duration_step:1,date_scale:"%d %M",task_date:"%d %F %Y",time_picker:"%H:%i",task_attribute:"task_id",link_attribute:"link_id",buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:true},{name:"time",height:72,type:"duration",map_to:"auto"}]},drag_lightbox:true,sort:false,details_on_create:true,details_on_dblclick:true,initial_scroll:true,task_scroll_offset:100,task_height:"full",min_column_width:70});gantt.keys={edit_save:13,edit_cancel:27};gantt._init_template=function(a){if(!this.config[a].$used){this.templates[a]=this.date.date_to_str(this.config[a]);this.config[a].$used=true}};gantt._init_templates=function(){var e=gantt.locale.labels;e.dhx_save_btn=e.icon_save;e.dhx_cancel_btn=e.icon_cancel;e.dhx_delete_btn=e.icon_delete;var a=this.date.date_to_str;var b=this.config;gantt._init_template("date_scale");gantt._init_template("date_grid");gantt._init_template("task_date");dhtmlx.mixin(this.templates,{xml_date:this.date.str_to_date(b.xml_date,b.server_utc),xml_format:a(b.xml_date,b.server_utc),api_date:this.date.str_to_date(b.api_date),progress_text:function(f,c,d){return""},grid_header_class:function(d,c){return""},task_text:function(f,c,d){return d.text},task_class:function(f,c,d){return""},grid_row_class:function(f,c,d){return""},task_row_class:function(f,c,d){return""},task_cell_class:function(d,c){return""},scale_cell_class:function(c){return""},task_class:function(f,c,d){return""},grid_indent:function(c){return"<div class='gantt_tree_indent'></div>"},grid_folder:function(c){return"<div class='gantt_tree_icon gantt_folder_"+(c.$open?"open":"closed")+"'></div>"},grid_file:function(c){return"<div class='gantt_tree_icon gantt_file'></div>"},grid_open:function(c){return"<div class='gantt_tree_icon gantt_"+(c.$open?"close":"open")+"'></div>"},grid_blank:function(c){return"<div class='gantt_tree_icon gantt_blank'></div>"},task_time:function(f,c,d){return gantt.templates.task_date(f)+" - "+gantt.templates.task_date(c)},time_picker:a(b.time_picker),link_class:function(c){return""},link_description:function(c){var f=gantt.getTask(c.source),d=gantt.getTask(c.target);return"<b>"+f.text+"</b> &ndash;  <b>"+d.text+"</b>"},drag_link:function(i,d,h,c){i=gantt.getTask(i);var g=gantt.locale.labels;var f="<b>"+i.text+"</b> "+(d?g.link_start:g.link_end)+"<br/>";if(h){h=gantt.getTask(h);f+="<b> "+h.text+"</b> "+(c?g.link_start:g.link_end)+"<br/>"}return f},drag_link_class:function(i,d,h,c){var f="";if(i&&h){var g=gantt.isLinkAllowed(i,h,d,c);f=" "+(g?"gantt_link_allow":"gantt_link_deny")}return"gantt_link_tooltip"+f}});this.callEvent("onTemplatesReady",[])}})();if(window.jQuery){(function(b){var a=[];b.fn.dhx_gantt=function(d){if(typeof(d)==="string"){if(a[d]){return a[d].apply(this,[])}else{b.error("Method "+d+" does not exist on jQuery.dhx_gantt")}}else{var c=[];this.each(function(){if(this&&this.getAttribute){if(!this.getAttribute("dhxgantt")){for(var e in d){if(e!="data"){gantt.config[e]=d[e]}}gantt.init(this);if(d.data){gantt.parse(d.data)}c.push(gantt)}}});if(c.length===1){return c[0]}return c}}})(jQuery)}gantt.locale={date:{month_full:["","","","","","","","","","","",""],month_short:["","","","","","","","","","","",""],day_full:["","","","","","",""],day_short:["","","","","","",""]},labels:{new_task:"",icon_save:"",icon_cancel:"",icon_details:"",icon_edit:"",icon_delete:"",confirm_closing:"",confirm_deleting:"?",section_description:"",section_time:"Time period",column_text:"",column_start_date:"",column_duration:"",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",minutes:"",hours:"",days:"",weeks:"",months:"",years:""}};gantt.skins.skyblue={config:{grid_width:350,row_height:27,scale_height:27,task_height:24,link_line_width:1,link_arrow_size:8,lightbox_additional_height:75},_second_column_width:95,_third_column_width:80};gantt.skins.meadow={config:{grid_width:350,row_height:27,scale_height:30,task_height:24,link_line_width:2,link_arrow_size:6,lightbox_additional_height:72},_second_column_width:95,_third_column_width:80};gantt.skins.terrace={config:{grid_width:360,row_height:35,scale_height:35,task_height:24,link_line_width:2,link_arrow_size:6,lightbox_additional_height:75},_second_column_width:90,_third_column_width:70};gantt.skins.broadway={config:{grid_width:360,row_height:35,scale_height:35,task_height:24,link_line_width:1,link_arrow_size:7,lightbox_additional_height:86},_second_column_width:90,_third_column_width:80,_lightbox_template:"<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span><div class='dhx_cancel_btn'></div></div><div class='dhx_cal_larea'></div>",_config_buttons_left:{},_config_buttons_right:{dhx_delete_btn:"icon_delete",dhx_save_btn:"icon_save"}};gantt.config.touch_drag=50;gantt.config.touch=true;gantt._init_touch_events=function(){if(this.config.touch!="force"){this.config.touch=this.config.touch&&((navigator.userAgent.indexOf("Mobile")!=-1)||(navigator.userAgent.indexOf("iPad")!=-1)||(navigator.userAgent.indexOf("Android")!=-1)||(navigator.userAgent.indexOf("Touch")!=-1))}if(this.config.touch){if(window.navigator.msPointerEnabled){this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(a){if(a.pointerType==a.MSPOINTER_TYPE_MOUSE){return null}return a},function(a){return(!a||a.pointerType==a.MSPOINTER_TYPE_MOUSE)})}else{this._touch_events(["touchmove","touchstart","touchend"],function(a){if(a.touches&&a.touches.length>1){return null}if(a.touches[0]){return{target:a.target,pageX:a.touches[0].pageX,pageY:a.touches[0].pageY}}else{return a}},function(){return false})}}};gantt._touch_events=function(g,c,f){var a=0;var h=false;var i=false;var e=0;var j=null;var b;if(!this._gantt_touch_event_ready){this._gantt_touch_event_ready=1;dhtmlxEvent(document.body,g[0],function(n){if(f(n)){return}if(!h){return}var m=c(n);if(m&&j){var l=j.pageX-m.pageX;var k=j.pageY-m.pageY;if(!i&&(Math.abs(l)>5||Math.abs(k)>5)){gantt._touch_scroll_active=i=true;a=0;b=gantt.getScrollState()}if(i){gantt.scrollTo(b.x+l,b.y+k)}}return d(n)})}function d(k){if(k&&k.preventDefault){k.preventDefault()}(k||event).cancelBubble=true;return false}dhtmlxEvent(this.$container,"contextmenu",function(k){if(h){return d(k)}});dhtmlxEvent(this.$container,g[1],function(l){if(f(l)){return}if(l.touches&&l.touches.length>1){h=false;return}h=true;j=c(l);if(j&&a){var k=new Date();if((k-a)<500){gantt._on_dblclick(j);d(l)}else{a=k}}else{a=new Date()}});dhtmlxEvent(this.$container,g[2],function(k){if(f(k)){return}gantt._touch_scroll_active=h=i=false})};