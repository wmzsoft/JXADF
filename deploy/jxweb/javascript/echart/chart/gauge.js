define("echarts/chart/gauge",["require","./base","../util/shape/GaugePointer","zrender/shape/Text","zrender/shape/Line","zrender/shape/Rectangle","zrender/shape/Circle","zrender/shape/Sector","../config","../util/ecData","../util/accMath","zrender/tool/util","../chart"],function(e){function t(e,t,a,i,r){s.call(this,e,t,a,i,r),this.refresh(i)}var s=e("./base"),a=e("../util/shape/GaugePointer"),i=e("zrender/shape/Text"),r=e("zrender/shape/Line"),o=e("zrender/shape/Rectangle"),l=e("zrender/shape/Circle"),h=e("zrender/shape/Sector"),n=e("../config");n.gauge={zlevel:0,z:2,center:["50%","50%"],clickable:!0,legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#228b22"],[.8,"#48b"],[1,"#ff4500"]],width:30}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,textStyle:{color:"auto"}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},pointer:{show:!0,length:"80%",width:8,color:"auto"},title:{show:!0,offsetCenter:[0,"-40%"],textStyle:{color:"#333",fontSize:15}},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:40,offsetCenter:[0,"40%"],textStyle:{color:"auto",fontSize:30}}};var d=e("../util/ecData"),u=e("../util/accMath"),c=e("zrender/tool/util");return t.prototype={type:n.CHART_TYPE_GAUGE,_buildShape:function(){var e=this.series;this._paramsMap={},this.selectedMap={};for(var t=0,s=e.length;s>t;t++)e[t].type===n.CHART_TYPE_GAUGE&&(this.selectedMap[e[t].name]=!0,e[t]=this.reformOption(e[t]),this.legendHoverLink=e[t].legendHoverLink||this.legendHoverLink,this._buildSingleGauge(t),this.buildMark(t));this.addShapeList()},_buildSingleGauge:function(e){var t=this.series[e];this._paramsMap[e]={center:this.parseCenter(this.zr,t.center),radius:this.parseRadius(this.zr,t.radius),startAngle:t.startAngle.toFixed(2)-0,endAngle:t.endAngle.toFixed(2)-0},this._paramsMap[e].totalAngle=this._paramsMap[e].startAngle-this._paramsMap[e].endAngle,this._colorMap(e),this._buildAxisLine(e),this._buildSplitLine(e),this._buildAxisTick(e),this._buildAxisLabel(e),this._buildPointer(e),this._buildTitle(e),this._buildDetail(e)},_buildAxisLine:function(e){var t=this.series[e];if(t.axisLine.show)for(var s,a,i=t.min,r=t.max-i,o=this._paramsMap[e],l=o.center,h=o.startAngle,n=o.totalAngle,u=o.colorArray,c=t.axisLine.lineStyle,f=this.parsePercent(c.width,o.radius[1]),p=o.radius[1],g=p-f,w=h,b=0,x=u.length;x>b;b++)a=h-n*(u[b][0]-i)/r,s=this._getSector(l,g,p,a,w,u[b][1],c,t.zlevel,t.z),w=a,s._animationAdd="r",d.set(s,"seriesIndex",e),d.set(s,"dataIndex",b),this.shapeList.push(s)},_buildSplitLine:function(e){var t=this.series[e];if(t.splitLine.show)for(var s,a,i,o=this._paramsMap[e],l=t.splitNumber,h=t.min,n=t.max-h,d=t.splitLine,u=this.parsePercent(d.length,o.radius[1]),c=d.lineStyle,f=c.color,p=o.center,g=o.startAngle*Math.PI/180,w=o.totalAngle*Math.PI/180,b=o.radius[1],x=b-u,_=0;l>=_;_++)s=g-w/l*_,a=Math.sin(s),i=Math.cos(s),this.shapeList.push(new r({zlevel:t.zlevel,z:t.z+1,hoverable:!1,style:{xStart:p[0]+i*b,yStart:p[1]-a*b,xEnd:p[0]+i*x,yEnd:p[1]-a*x,strokeColor:"auto"===f?this._getColor(e,h+n/l*_):f,lineType:c.type,lineWidth:c.width,shadowColor:c.shadowColor,shadowBlur:c.shadowBlur,shadowOffsetX:c.shadowOffsetX,shadowOffsetY:c.shadowOffsetY}}))},_buildAxisTick:function(e){var t=this.series[e];if(t.axisTick.show)for(var s,a,i,o=this._paramsMap[e],l=t.splitNumber,h=t.min,n=t.max-h,d=t.axisTick,u=d.splitNumber,c=this.parsePercent(d.length,o.radius[1]),f=d.lineStyle,p=f.color,g=o.center,w=o.startAngle*Math.PI/180,b=o.totalAngle*Math.PI/180,x=o.radius[1],_=x-c,v=0,y=l*u;y>=v;v++)v%u!==0&&(s=w-b/y*v,a=Math.sin(s),i=Math.cos(s),this.shapeList.push(new r({zlevel:t.zlevel,z:t.z+1,hoverable:!1,style:{xStart:g[0]+i*x,yStart:g[1]-a*x,xEnd:g[0]+i*_,yEnd:g[1]-a*_,strokeColor:"auto"===p?this._getColor(e,h+n/y*v):p,lineType:f.type,lineWidth:f.width,shadowColor:f.shadowColor,shadowBlur:f.shadowBlur,shadowOffsetX:f.shadowOffsetX,shadowOffsetY:f.shadowOffsetY}})))},_buildAxisLabel:function(e){var t=this.series[e];if(t.axisLabel.show)for(var s,a,r,o,l=t.splitNumber,h=t.min,n=t.max-h,d=t.axisLabel.textStyle,c=this.getFont(d),f=d.color,p=this._paramsMap[e],g=p.center,w=p.startAngle,b=p.totalAngle,x=p.radius[1]-this.parsePercent(t.splitLine.length,p.radius[1])-5,_=0;l>=_;_++)o=u.accAdd(h,u.accMul(u.accDiv(n,l),_)),s=w-b/l*_,a=Math.sin(s*Math.PI/180),r=Math.cos(s*Math.PI/180),s=(s+360)%360,this.shapeList.push(new i({zlevel:t.zlevel,z:t.z+1,hoverable:!1,style:{x:g[0]+r*x,y:g[1]-a*x,color:"auto"===f?this._getColor(e,o):f,text:this._getLabelText(t.axisLabel.formatter,o),textAlign:s>=110&&250>=s?"left":70>=s||s>=290?"right":"center",textBaseline:s>=10&&170>=s?"top":s>=190&&350>=s?"bottom":"middle",textFont:c,shadowColor:d.shadowColor,shadowBlur:d.shadowBlur,shadowOffsetX:d.shadowOffsetX,shadowOffsetY:d.shadowOffsetY}}))},_buildPointer:function(e){var t=this.series[e];if(t.pointer.show){var s=t.max-t.min,i=t.pointer,r=this._paramsMap[e],o=this.parsePercent(i.length,r.radius[1]),h=this.parsePercent(i.width,r.radius[1]),n=r.center,u=this._getValue(e);u=u<t.max?u:t.max;var c=(r.startAngle-r.totalAngle/s*(u-t.min))*Math.PI/180,f="auto"===i.color?this._getColor(e,u):i.color,p=new a({zlevel:t.zlevel,z:t.z+1,clickable:this.query(t,"clickable"),style:{x:n[0],y:n[1],r:o,startAngle:r.startAngle*Math.PI/180,angle:c,color:f,width:h,shadowColor:i.shadowColor,shadowBlur:i.shadowBlur,shadowOffsetX:i.shadowOffsetX,shadowOffsetY:i.shadowOffsetY},highlightStyle:{brushType:"fill",width:h>2?2:h/2,color:"#fff"}});d.pack(p,this.series[e],e,this.series[e].data[0],0,this.series[e].data[0].name,u),this.shapeList.push(p),this.shapeList.push(new l({zlevel:t.zlevel,z:t.z+2,hoverable:!1,style:{x:n[0],y:n[1],r:i.width/2.5,color:"#fff"}}))}},_buildTitle:function(e){var t=this.series[e];if(t.title.show){var s=t.data[0],a=null!=s.name?s.name:"";if(""!==a){var r=t.title,o=r.offsetCenter,l=r.textStyle,h=l.color,n=this._paramsMap[e],d=n.center[0]+this.parsePercent(o[0],n.radius[1]),u=n.center[1]+this.parsePercent(o[1],n.radius[1]);this.shapeList.push(new i({zlevel:t.zlevel,z:t.z+(Math.abs(d-n.center[0])+Math.abs(u-n.center[1])<2*l.fontSize?2:1),hoverable:!1,style:{x:d,y:u,color:"auto"===h?this._getColor(e):h,text:a,textAlign:"center",textFont:this.getFont(l),shadowColor:l.shadowColor,shadowBlur:l.shadowBlur,shadowOffsetX:l.shadowOffsetX,shadowOffsetY:l.shadowOffsetY}}))}}},_buildDetail:function(e){var t=this.series[e];if(t.detail.show){var s=t.detail,a=s.offsetCenter,i=s.backgroundColor,r=s.textStyle,l=r.color,h=this._paramsMap[e],n=this._getValue(e),d=h.center[0]-s.width/2+this.parsePercent(a[0],h.radius[1]),u=h.center[1]+this.parsePercent(a[1],h.radius[1]);this.shapeList.push(new o({zlevel:t.zlevel,z:t.z+(Math.abs(d+s.width/2-h.center[0])+Math.abs(u+s.height/2-h.center[1])<r.fontSize?2:1),hoverable:!1,style:{x:d,y:u,width:s.width,height:s.height,brushType:"both",color:"auto"===i?this._getColor(e,n):i,lineWidth:s.borderWidth,strokeColor:s.borderColor,shadowColor:s.shadowColor,shadowBlur:s.shadowBlur,shadowOffsetX:s.shadowOffsetX,shadowOffsetY:s.shadowOffsetY,text:this._getLabelText(s.formatter,n),textFont:this.getFont(r),textPosition:"inside",textColor:"auto"===l?this._getColor(e,n):l}}))}},_getValue:function(e){return this.getDataFromOption(this.series[e].data[0])},_colorMap:function(e){var t=this.series[e],s=t.min,a=t.max-s,i=t.axisLine.lineStyle.color;i instanceof Array||(i=[[1,i]]);for(var r=[],o=0,l=i.length;l>o;o++)r.push([i[o][0]*a+s,i[o][1]]);this._paramsMap[e].colorArray=r},_getColor:function(e,t){null==t&&(t=this._getValue(e));for(var s=this._paramsMap[e].colorArray,a=0,i=s.length;i>a;a++)if(s[a][0]>=t)return s[a][1];return s[s.length-1][1]},_getSector:function(e,t,s,a,i,r,o,l,n){return new h({zlevel:l,z:n,hoverable:!1,style:{x:e[0],y:e[1],r0:t,r:s,startAngle:a,endAngle:i,brushType:"fill",color:r,shadowColor:o.shadowColor,shadowBlur:o.shadowBlur,shadowOffsetX:o.shadowOffsetX,shadowOffsetY:o.shadowOffsetY}})},_getLabelText:function(e,t){if(e){if("function"==typeof e)return e.call(this.myChart,t);if("string"==typeof e)return e.replace("{value}",t)}return t},refresh:function(e){e&&(this.option=e,this.series=e.series),this.backupShapeList(),this._buildShape()}},c.inherits(t,s),e("../chart").define("gauge",t),t}),define("echarts/util/shape/GaugePointer",["require","zrender/shape/Base","zrender/tool/util","./normalIsCover"],function(e){function t(e){s.call(this,e)}var s=e("zrender/shape/Base"),a=e("zrender/tool/util");return t.prototype={type:"gauge-pointer",buildPath:function(e,t){var s=t.r,a=t.width,i=t.angle,r=t.x-Math.cos(i)*a*(a>=s/3?1:2),o=t.y+Math.sin(i)*a*(a>=s/3?1:2);i=t.angle-Math.PI/2,e.moveTo(r,o),e.lineTo(t.x+Math.cos(i)*a,t.y-Math.sin(i)*a),e.lineTo(t.x+Math.cos(t.angle)*s,t.y-Math.sin(t.angle)*s),e.lineTo(t.x-Math.cos(i)*a,t.y+Math.sin(i)*a),e.lineTo(r,o)},getRect:function(e){if(e.__rect)return e.__rect;var t=2*e.width,s=e.x,a=e.y,i=s+Math.cos(e.angle)*e.r,r=a-Math.sin(e.angle)*e.r;return e.__rect={x:Math.min(s,i)-t,y:Math.min(a,r)-t,width:Math.abs(s-i)+t,height:Math.abs(a-r)+t},e.__rect},isCover:e("./normalIsCover")},a.inherits(t,s),t});